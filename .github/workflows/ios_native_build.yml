name: iOS Native Build

on:
  push:
    branches:
      - main  # 当推送到 'main' 分支时触发工作流

jobs:
  build-ios:
    runs-on: macos-latest

    steps:
    # 检出代码
    - name: Checkout repository
      uses: actions/checkout@v4

    # 清除 Xcode 缓存
    - name: Clean Xcode Cache
      run: |
        rm -rf ~/Library/Developer/Xcode/DerivedData
        rm -rf ~/Library/Developer/Xcode/iOS\ DeviceSupport
        rm -rf ~/Library/Developer/Xcode/Archives
        rm -rf ~/Library/Developer/Xcode/Products
    
    # 选择 Xcode 版本
    - name: Select Xcode 16.2
      run: sudo xcode-select -s /Applications/Xcode_16.2.app
      
    # 设置 CocoaPods
    - name: Setup CocoaPods
      run: |
        echo "开始安装 CocoaPods 依赖..."
        pod install

    # 打印环境信息
    - name: Print Environment Info
      run: |
        echo "============= Environment Variables ============="
        echo "Current Directory: $(pwd)"
        echo "Xcode Version:"
        xcodebuild -version
        echo "============= Available Schemes ============="
        WORKSPACE_FILE=$(ls *.xcworkspace | head -n 1)
        echo "使用 workspace: $WORKSPACE_FILE"
        xcodebuild -workspace "$WORKSPACE_FILE" -list
 
    # 安装证书步骤
    - name: Install Certificate
      env:
        BUILD_CERTIFICATE_BASE64: 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

        P12_PASSWORD: 111111
        KEYCHAIN_PASSWORD: 111111
      run: |
        echo "$BUILD_CERTIFICATE_BASE64" | base64 --decode > certificate.p12
        security create-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security default-keychain -s build.keychain
        security unlock-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security set-keychain-settings -t 3600 -u build.keychain
        security import certificate.p12 -k build.keychain -P "$P12_PASSWORD" -T /usr/bin/codesign
        security set-key-partition-list -S apple-tool:,apple: -s -k "$KEYCHAIN_PASSWORD" build.keychain
        rm certificate.p12

    # 安装描述文件步骤
    - name: Install Provisioning Profile
      env:
        PROVISIONING_PROFILE_BASE64: MIIv2AYJKoZIhvcNAQcCoIIvyTCCL8UCAQExCzAJBgUrDgMCGgUAMIIf5QYJKoZIhvcNAQcBoIIf1gSCH9I8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+Y29tNUozNkpaNUdRWjwvc3RyaW5nPgoJPGtleT5BcHBsaWNhdGlvbklkZW50aWZpZXJQcmVmaXg8L2tleT4KCTxhcnJheT4KCTxzdHJpbmc+NUozNkpaNUdRWjwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+Q3JlYXRpb25EYXRlPC9rZXk+Cgk8ZGF0ZT4yMDI1LTA2LTIzVDEzOjQ3OjUzWjwvZGF0ZT4KCTxrZXk+UGxhdGZvcm08L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPmlPUzwvc3RyaW5nPgoJCTxzdHJpbmc+eHJPUzwvc3RyaW5nPgoJCTxzdHJpbmc+dmlzaW9uT1M8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PklzWGNvZGVNYW5hZ2VkPC9rZXk+Cgk8ZmFsc2UvPgoJPGtleT5EZXZlbG9wZXJDZXJ0aWZpY2F0ZXM8L2tleT4KCTxhcnJheT4KCQk8ZGF0YT5NSUlGeVRDQ0JMR2dBd0lCQWdJUVV3ZzBaY3VjNFJkVUlzL21LdlhmMERBTkJna3Foa2lHOXcwQkFRc0ZBREIxTVVRd1FnWURWUVFERER0QmNIQnNaU0JYYjNKc1pIZHBaR1VnUkdWMlpXeHZjR1Z5SUZKbGJHRjBhVzl1Y3lCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVMTUFrR0ExVUVDd3dDUnpNeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhDekFKQmdOVkJBWVRBbFZUTUI0WERUSTFNRFl5TXpFek1qQXdNMW9YRFRJMk1EWXlNekV6TWpBd01sb3dnWTh4R2pBWUJnb0praWFKay9Jc1pBRUJEQW8xU2pNMlNsbzFSMUZhTVRjd05RWURWUVFEREM1QmNIQnNaU0JFYVhOMGNtbGlkWFJwYjI0NklGaHBZVzl3YVc1bklHeHBZVzRnS0RWS016WktXalZIVVZvcE1STXdFUVlEVlFRTERBbzFTak0yU2xvMVIxRmFNUll3RkFZRFZRUUtEQTFZYVdGdmNHbHVaeUJzYVdGdU1Rc3dDUVlEVlFRR0V3SkRUakNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMVTl5WkpCTU9JNkp3Z014TDVuQlhSdWVKZW11Y1RSZGRSLzJ1KytyMFV2MVBtM2JJVDlaK05QNGVORUFhYW1aMkRpN1BqTFZ5MStWbnl0VVp5L1l1emI2dVhYNlRacmpXejFQVEpTUDIveW5qazUyUVZxWkIxNUhUK3hmTnZDZjFzMkh5ZjFhMXhOSDNoR2Q5Q0gzSElTMU1lMXQrRzBTQ1gxRHQ2bXA1NzNuTzh6MUdLN1RmdUVBYTYzZlBxd3g0RnRXaFJkOVlVdUhYajBFOUVFME8rQnZ0NzhZbHY1eEZERnAyYjRSNDdESnVMUVdRa2lSNWExbloyN3U1aUNuYmNkUk93WkdoTDI1UUpLMUNsdWF1NEt4SG5VeEs0VkFKZC9ySUFDQnJRT0NqU0RkVzFKazhYQ01ZUWswMlZnS0ZvbTJnU1QxTGRBRENNYnpTcWZEdFVDQXdFQUFhT0NBamd3Z2dJME1Bd0dBMVVkRXdFQi93UUNNQUF3SHdZRFZSMGpCQmd3Rm9BVUNmN0FGWkQ1cjJRS2toSzVKaWhqREpmc3A3SXdjQVlJS3dZQkJRVUhBUUVFWkRCaU1DMEdDQ3NHQVFVRkJ6QUNoaUZvZEhSd09pOHZZMlZ5ZEhNdVlYQndiR1V1WTI5dEwzZDNaSEpuTXk1a1pYSXdNUVlJS3dZQkJRVUhNQUdHSldoMGRIQTZMeTl2WTNOd0xtRndjR3hsTG1OdmJTOXZZM053TURNdGQzZGtjbWN6TURVd2dnRWVCZ05WSFNBRWdnRVZNSUlCRVRDQ0FRMEdDU3FHU0liM1kyUUZBVENCL3pDQnd3WUlLd1lCQlFVSEFnSXdnYllNZ2JOU1pXeHBZVzVqWlNCdmJpQjBhR2x6SUdObGNuUnBabWxqWVhSbElHSjVJR0Z1ZVNCd1lYSjBlU0JoYzNOMWJXVnpJR0ZqWTJWd2RHRnVZMlVnYjJZZ2RHaGxJSFJvWlc0Z1lYQndiR2xqWVdKc1pTQnpkR0Z1WkdGeVpDQjBaWEp0Y3lCaGJtUWdZMjl1WkdsMGFXOXVjeUJ2WmlCMWMyVXNJR05sY25ScFptbGpZWFJsSUhCdmJHbGplU0JoYm1RZ1kyVnlkR2xtYVdOaGRHbHZiaUJ3Y21GamRHbGpaU0J6ZEdGMFpXMWxiblJ6TGpBM0JnZ3JCZ0VGQlFjQ0FSWXJhSFIwY0hNNkx5OTNkM2N1WVhCd2JHVXVZMjl0TDJObGNuUnBabWxqWVhSbFlYVjBhRzl5YVhSNUx6QVdCZ05WSFNVQkFmOEVEREFLQmdnckJnRUZCUWNEQXpBZEJnTlZIUTRFRmdRVUNJT0YwOXliMksrd1dwZzZLdktKWW5rUlI5OHdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1CTUdDaXFHU0liM1kyUUdBUWNCQWY4RUFnVUFNQk1HQ2lxR1NJYjNZMlFHQVFRQkFmOEVBZ1VBTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCakRaakszWksybStUM1dKM3drbmE5WmcrdzltTE9CYTJhNHlPT2NiaUxHMitaam1xSzZxem0xeVdmV1lHMncxKzFFcXFaOUIxQ3V6bExjaUh0VENNdjRBM3dJSkJtU1NvWXl5MXVTek5rWjJLYm5ZaWN2aHNXTzJmYzY4a0VyY2U4azQ1QVZiSHE1UzlRY3d6dHNOMjNoZHB3U3NPUm1LRGdyVnVTTFJmYjE0R3lkazFGK2xTYVRaSHNTRFY0YzhLckZXN0dXUjNKWWJHRU5RSVpVQVRBajBjc2g3YnE4RCtHVTNSamRtTGd1eWl4VnlSMTFVcFVEamlTbURPMWJXWDJtZ3RzL0w3SWVoWFJwVkRDNHc5WkJ4bTJ5YXBnbjFhVHFyTGx6ZXFGaGJudG9Oc0pkeHA5czdEQkducC9FdmFrWGJIaDBpdm96Z21zMWNnQTJRUXA8L2RhdGE+Cgk8L2FycmF5PgoKCTxrZXk+REVSLUVuY29kZWQtUHJvZmlsZTwva2V5PgoJPGRhdGE+TUlJTlJnWUpLb1pJaHZjTkFRY0NvSUlOTnpDQ0RUTUNBUUV4RHpBTkJnbGdoa2dCWlFNRUFnRUZBRENDQXY4R0NTcUdTSWIzRFFFSEFhQ0NBdkFFZ2dMc01ZSUM2REFNREFkV1pYSnphVzl1QWdFQk1BME1DRkJRVVVOb1pXTnJBUUVBTUJBTUNsUnBiV1ZVYjB4cGRtVUNBZ0ZzTUJNTURrbHpXR052WkdWTllXNWhaMlZrQVFFQU1Ca01DRlJsWVcxT1lXMWxEQTFZYVdGdmNHbHVaeUJzYVdGdU1Cb01DVUZ3Y0VsRVRtRnRaUXdOWTI5dE5Vb3pOa3BhTlVkUldqQWREQXhEY21WaGRHbHZia1JoZEdVWERUSTFNRFl5TXpFek5EYzFNMW93SGd3T1ZHVmhiVWxrWlc1MGFXWnBaWEl3REF3S05Vb3pOa3BhTlVkUldqQWZEQTVGZUhCcGNtRjBhVzl1UkdGMFpSY05Nall3TmpJek1UTXlNREF5V2pBZ0RCZFFjbTltYVd4bFJHbHpkSEpwWW5WMGFXOXVWSGx3WlF3RlUxUlBVa1V3SVF3SVVHeGhkR1p2Y20wd0ZRd0RhVTlUREFSNGNrOVREQWgyYVhOcGIyNVBVekFpREFST1lXMWxEQnBqYjIwMVNqTTJTbG8xUjFGYVgyUnBjMTh5TURJMU1EWXlNekFyREJ0QmNIQnNhV05oZEdsdmJrbGtaVzUwYVdacFpYSlFjbVZtYVhnd0RBd0tOVW96TmtwYU5VZFJXakFzREFSVlZVbEVEQ1ExTkdJNFpXSm1PQzB3TlRWaExUUXdOalV0T0dGaU1TMHdOV0kyTVRoaU16WTFPRFF3T3d3VlJHVjJaV3h2Y0dWeVEyVnlkR2xtYVdOaGRHVnpNQ0lFSUZuc3hRczMydUJiZ25wYkt4S3hOM1hTZ1FFdlZ2dTAyK012cjV2TXRxWUVNSUlCQ0F3TVJXNTBhWFJzWlcxbGJuUnpjSUgzQWdFQnNJSHhNRE1NRm1Gd2NHeHBZMkYwYVc5dUxXbGtaVzUwYVdacFpYSU1HVFZLTXpaS1dqVkhVVm91WTI5dExqVktNelpLV2pWSFVWb3dIUXdQWVhCekxXVnVkbWx5YjI1dFpXNTBEQXB3Y205a2RXTjBhVzl1TUJnTUUySmxkR0V0Y21Wd2IzSjBjeTFoWTNScGRtVUJBZjh3TVF3alkyOXRMbUZ3Y0d4bExtUmxkbVZzYjNCbGNpNTBaV0Z0TFdsa1pXNTBhV1pwWlhJTUNqVktNelpLV2pWSFVWb3dFd3dPWjJWMExYUmhjMnN0WVd4c2IzY0JBUUF3T1F3V2EyVjVZMmhoYVc0dFlXTmpaWE56TFdkeWIzVndjekFmREF3MVNqTTJTbG8xUjFGYUxpb01EMk52YlM1aGNIQnNaUzUwYjJ0bGJxQ0NDRHd3Z2dKRE1JSUJ5YUFEQWdFQ0FnZ3R4ZnlJMHNWTGxUQUtCZ2dxaGtqT1BRUURBekJuTVJzd0dRWURWUVFEREJKQmNIQnNaU0JTYjI5MElFTkJJQzBnUnpNeEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV6QWVGdzB4TkRBME16QXhPREU1TURaYUZ3MHpPVEEwTXpBeE9ERTVNRFphTUdjeEd6QVpCZ05WQkFNTUVrRndjR3hsSUZKdmIzUWdRMEVnTFNCSE16RW1NQ1FHQTFVRUN3d2RRWEJ3YkdVZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNSFl3RUFZSEtvWkl6ajBDQVFZRks0RUVBQ0lEWWdBRW1Pa3ZQVUJ5cE8yVEluS0JFeHpkRUpYeHhhTk9jZHdVRnRrTzVhWUZLbmRrZTE5T09OTzdIRVMxZi9VZnRqSmlYY25waEZ0UE1FOFJXZ0Q5V0ZnTXBmVVBMRTBIUnhOMTJwZVhsMjh4WE8wcm5Yc2dPOWk1Vk5sZW1hUTZVUW94bzBJd1FEQWRCZ05WSFE0RUZnUVV1N0Rlb1ZnemlKcWtpcG5ldnIzcnI5ckxKS3N3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFPQmdOVkhROEJBZjhFQkFNQ0FRWXdDZ1lJS29aSXpqMEVBd01EYUFBd1pRSXhBSVBwd2NRV1hocGROQmpaN2UvMGJBNEFSa3U0MzdKR0VjVVAvZVo2aktHbWE4N0NBOVNjOVpQR2RMaHEzNm9qRlFJd2JXYUtFTXJVRGRSUHpZMURQclNLWTZVemJ1TnQyaGUzWkIvSVV5YjVpR0owT1FzWFc4dFJxQXpvR0FQbm9ySW9NSUlDNWpDQ0FtMmdBd0lCQWdJSU13M3UrTDlNYUM0d0NnWUlLb1pJemowRUF3TXdaekViTUJrR0ExVUVBd3dTUVhCd2JHVWdVbTl2ZENCRFFTQXRJRWN6TVNZd0pBWURWUVFMREIxQmNIQnNaU0JEWlhKMGFXWnBZMkYwYVc5dUlFRjFkR2h2Y21sMGVURVRNQkVHQTFVRUNnd0tRWEJ3YkdVZ1NXNWpMakVMTUFrR0ExVUVCaE1DVlZNd0hoY05NVGN3TWpJeU1qSXlNekl5V2hjTk16SXdNakU0TURBd01EQXdXakJ5TVNZd0pBWURWUVFEREIxQmNIQnNaU0JUZVhOMFpXMGdTVzUwWldkeVlYUnBiMjRnUTBFZ05ERW1NQ1FHQTFVRUN3d2RRWEJ3YkdVZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVCbXVrVm05OW55ZlJ6amFPa2h0V3pWUTJaRXJKbEdpWitza2dmdUwxV0EvYzRtcnJHVWN2THU4N3BBRzBBUk5FZkZvbXJhQ2NLU1dLNWVZR2IwOThXcU9COXpDQjlEQVBCZ05WSFJNQkFmOEVCVEFEQVFIL01COEdBMVVkSXdRWU1CYUFGTHV3M3FGWU00aWFwSXFaM3I2OTY2L2F5eVNyTUVZR0NDc0dBUVVGQndFQkJEb3dPREEyQmdnckJnRUZCUWN3QVlZcWFIUjBjRG92TDI5amMzQXVZWEJ3YkdVdVkyOXRMMjlqYzNBd015MWhjSEJzWlhKdmIzUmpZV2N6TURjR0ExVWRId1F3TUM0d0xLQXFvQ2lHSm1oMGRIQTZMeTlqY213dVlYQndiR1V1WTI5dEwyRndjR3hsY205dmRHTmhaek11WTNKc01CMEdBMVVkRGdRV0JCUjZSN280aWhVa1NDSkd6YjZQR2lSN05BTXFhVEFPQmdOVkhROEJBZjhFQkFNQ0FRWXdFQVlLS29aSWh2ZGpaQVlDRVFRQ0JRQXdDZ1lJS29aSXpqMEVBd01EWndBd1pBSXdGUXlwanNhdmxtbHJwNS9kWE5RRFdXeXVVdFJneG90MjRMZkZvdkVKZk9DYTQydXg0M3d4eENkNnA0NkovYXQzQWpCaE15RHhLZi81aHpLdUtjaGtQWFo3VWFUU0FpOTJ2bUFpa2ZIVk9uWGN0T0xHS3BiK3hnbmNTay9WSlBEOHlySXdnZ01ITUlJQ3JhQURBZ0VDQWdnWGdLZzBabVRxeXpBS0JnZ3Foa2pPUFFRREFqQnlNU1l3SkFZRFZRUUREQjFCY0hCc1pTQlRlWE4wWlcwZ1NXNTBaV2R5WVhScGIyNGdRMEVnTkRFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEkwTVRFeU1EQXpNakEwTlZvWERUSTRNVEl4TkRFNE1EQXpNRm93VGpFcU1DZ0dBMVVFQXd3aFYxZEVVaUJRY205MmFYTnBiMjVwYm1jZ1VISnZabWxzWlNCVGFXZHVhVzVuTVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCUFdVV3c3QjFGUS9HZDVHWUNWZlBvNHB6MnhQazlVY3QzMjJVbDhmNGZ0akFiS0NHNmloVHJUVDdlOVd1UmZVbU0xZ3Q4NU9xYmM2VjNaVDZETkRyMzJqZ2dGUE1JSUJTekFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUFGSHBIdWppS0ZTUklJa2JOdm84YUpIczBBeXBwTUVFR0NDc0dBUVVGQndFQkJEVXdNekF4QmdnckJnRUZCUWN3QVlZbGFIUjBjRG92TDI5amMzQXVZWEJ3YkdVdVkyOXRMMjlqYzNBd015MWhjMmxqWVRRd016Q0JsZ1lEVlIwZ0JJR09NSUdMTUlHSUJna3Foa2lHOTJOa0JRRXdlekI1QmdnckJnRUZCUWNDQWpCdERHdFVhR2x6SUdObGNuUnBabWxqWVhSbElHbHpJSFJ2SUdKbElIVnpaV1FnWlhoamJIVnphWFpsYkhrZ1ptOXlJR1oxYm1OMGFXOXVjeUJwYm5SbGNtNWhiQ0IwYnlCQmNIQnNaU0JRY205a2RXTjBjeUJoYm1RdmIzSWdRWEJ3YkdVZ2NISnZZMlZ6YzJWekxqQWRCZ05WSFE0RUZnUVU2VkxPRGJER2lCcGxTcmliRVkveDNCNUhGSHd3RGdZRFZSMFBBUUgvQkFRREFnZUFNQThHQ1NxR1NJYjNZMlFNRXdRQ0JRQXdDZ1lJS29aSXpqMEVBd0lEU0FBd1JRSWhBTythdkYyZ1dtWnNaTG5OTjVPcFU3UTN4Y2RzNFlQNkZ4cmVDejNXcTJobUFpQjRJOW5EaUFkSlBmWDdpWStRYmxqZ1Y1OWovMWpoMW85Y21HUFdPajQvblRHQ0FkZ3dnZ0hVQWdFQk1INHdjakVtTUNRR0ExVUVBd3dkUVhCd2JHVWdVM2x6ZEdWdElFbHVkR1ZuY21GMGFXOXVJRU5CSURReEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV3SUlGNENvTkdaazZzc3dEUVlKWUlaSUFXVURCQUlCQlFDZ2dla3dHQVlKS29aSWh2Y05BUWtETVFzR0NTcUdTSWIzRFFFSEFUQWNCZ2txaGtpRzl3MEJDUVV4RHhjTk1qVXdOakl6TVRNME56VXpXakFxQmdrcWhraUc5dzBCQ1RReEhUQWJNQTBHQ1dDR1NBRmxBd1FDQVFVQW9Rb0dDQ3FHU000OUJBTUNNQzhHQ1NxR1NJYjNEUUVKQkRFaUJDQ2xPNnNkRSt0TFVDTTlBeFdQUkZna3NDcHhYN2kvT0tTbGszL3pqZmhtTHpCU0Jna3Foa2lHOXcwQkNROHhSVEJETUFvR0NDcUdTSWIzRFFNSE1BNEdDQ3FHU0liM0RRTUNBZ0lBZ0RBTkJnZ3Foa2lHOXcwREFnSUJRREFIQmdVckRnTUNCekFOQmdncWhraUc5dzBEQWdJQktEQUtCZ2dxaGtqT1BRUURBZ1JJTUVZQ0lRRHFOdnZ5Q1QzYXZrMmxtZzFLYUhoQzJWK2NySnZ5SnEwVDlSZnJOeDk5YkFJaEFKcHFLdG5HaFdCbUNLanFEeUZWMHBrdHphL1EyblZBQ2QvazZ5eDEzeUQzPC9kYXRhPgoJCQkJCQkJCQkJCQkJCQoJCQk8a2V5PlBQUUNoZWNrPC9rZXk+Cgk8ZmFsc2UvPgoKCTxrZXk+RW50aXRsZW1lbnRzPC9rZXk+Cgk8ZGljdD4KCQk8a2V5PmJldGEtcmVwb3J0cy1hY3RpdmU8L2tleT4KCQk8dHJ1ZS8+CgkJCQkKCQkJCTxrZXk+YXBzLWVudmlyb25tZW50PC9rZXk+CgkJPHN0cmluZz5wcm9kdWN0aW9uPC9zdHJpbmc+CgkJCQkKCQkJCTxrZXk+YXBwbGljYXRpb24taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+NUozNkpaNUdRWi5jb20uNUozNkpaNUdRWjwvc3RyaW5nPgoJCQkJCgkJCQk8a2V5PmtleWNoYWluLWFjY2Vzcy1ncm91cHM8L2tleT4KCQk8YXJyYXk+CgkJCQk8c3RyaW5nPjVKMzZKWjVHUVouKjwvc3RyaW5nPgoJCQkJPHN0cmluZz5jb20uYXBwbGUudG9rZW48L3N0cmluZz4KCQk8L2FycmF5PgoJCQkJCgkJCQk8a2V5PmdldC10YXNrLWFsbG93PC9rZXk+CgkJPGZhbHNlLz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLnRlYW0taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+NUozNkpaNUdRWjwvc3RyaW5nPgoJCQoJPC9kaWN0PgoJPGtleT5FeHBpcmF0aW9uRGF0ZTwva2V5PgoJPGRhdGU+MjAyNi0wNi0yM1QxMzoyMDowMlo8L2RhdGU+Cgk8a2V5Pk5hbWU8L2tleT4KCTxzdHJpbmc+Y29tNUozNkpaNUdRWl9kaXNfMjAyNTA2MjM8L3N0cmluZz4KCTxrZXk+VGVhbUlkZW50aWZpZXI8L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPjVKMzZKWjVHUVo8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PlRlYW1OYW1lPC9rZXk+Cgk8c3RyaW5nPlhpYW9waW5nIGxpYW48L3N0cmluZz4KCTxrZXk+VGltZVRvTGl2ZTwva2V5PgoJPGludGVnZXI+MzY0PC9pbnRlZ2VyPgoJPGtleT5VVUlEPC9rZXk+Cgk8c3Ry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

      run: |
        echo "$PROVISIONING_PROFILE_BASE64" | base64 --decode > provisioning.mobileprovision
        mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
        cp provisioning.mobileprovision ~/Library/MobileDevice/Provisioning\ Profiles/
        rm provisioning.mobileprovision

    # 检查 ExportOptions.plist 文件
    - name: Check ExportOptions.plist
      run: |
        if [ -f "ExportOptions.plist" ]; then
          echo "找到 ExportOptions.plist 文件"
          cat ExportOptions.plist
        else
          echo "错误：未找到 ExportOptions.plist 文件"
          exit 1
        fi

    # 构建和归档 iOS 应用
    - name: Build and Archive iOS App
      run: |
        # 创建构建目录
        mkdir -p build
        
        # 查找 workspace 文件
        WORKSPACE_FILE=$(ls *.xcworkspace | head -n 1)
        if [ -z "$WORKSPACE_FILE" ]; then
          echo "错误：未找到 .xcworkspace 文件"
          exit 1
        fi
        
        echo "使用 workspace: $WORKSPACE_FILE"
        echo "使用 scheme: Riverla"
        
        # 构建和归档
        xcodebuild -workspace "$WORKSPACE_FILE" \
          -scheme "Riverla" \
          -configuration "Release" \
          -destination 'generic/platform=iOS' \
          -archivePath "$PWD/build/App.xcarchive" \
          archive \
          -allowProvisioningUpdates

    # 导出 IPA
    - name: Export IPA
      run: |
        xcodebuild -exportArchive \
          -archivePath "$PWD/build/App.xcarchive" \
          -exportOptionsPlist ExportOptions.plist \
          -exportPath "$PWD/build/ipa"

    # 检查构建结果
    - name: Check Build Files
      run: |
        ls -la build/ipa/

    # 上传 IPA 作为 artifact
    - name: Archive IPA
      uses: actions/upload-artifact@v4
      with:
        name: release-ipa
        path: build/ipa/*.ipa

    # 上传到 App Store
    - name: Upload to App Store using altool
      if: github.ref == 'refs/heads/main'  # 只在 main 分支上传
      env:
        APPLE_ID: "BaseFormatter@hotmail.com"
        APP_SPECIFIC_PASSWORD: "ckvo-zxie-wmey-haam"
      run: |
        # 查找生成的 IPA 文件
        IPA_FILE=$(find build/ipa -name "*.ipa" | head -n 1)
        if [ -z "$IPA_FILE" ]; then
          echo "错误：未找到 IPA 文件"
          exit 1
        fi
        
        echo "上传 IPA 文件: $IPA_FILE"
        xcrun altool --upload-app -f "$IPA_FILE" \
          -t ios \
          -u "$APPLE_ID" \
          -p "$APP_SPECIFIC_PASSWORD" \
          --verbose

    # 清理
    - name: Cleanup
      if: always()
      run: |
        # 删除临时 keychain
        security delete-keychain build.keychain || true 
