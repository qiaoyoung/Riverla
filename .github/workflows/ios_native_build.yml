name: iOS Native Build

on:
  push:
    branches:
      - main  # 当推送到 'main' 分支时触发工作流

jobs:
  build-ios:
    runs-on: macos-latest

    steps:
    # 检出代码
    - name: Checkout repository
      uses: actions/checkout@v4

    # 清除 Xcode 缓存
    - name: Clean Xcode Cache
      run: |
        rm -rf ~/Library/Developer/Xcode/DerivedData
        rm -rf ~/Library/Developer/Xcode/iOS\ DeviceSupport
        rm -rf ~/Library/Developer/Xcode/Archives
        rm -rf ~/Library/Developer/Xcode/Products
    
    # 选择 Xcode 版本
    - name: Select Xcode 16.2
      run: sudo xcode-select -s /Applications/Xcode_16.2.app
      
    # 设置 CocoaPods
    - name: Setup CocoaPods
      run: |
        echo "开始安装 CocoaPods 依赖..."
        pod install

    # 打印环境信息
    - name: Print Environment Info
      run: |
        echo "============= Environment Variables ============="
        echo "Current Directory: $(pwd)"
        echo "Xcode Version:"
        xcodebuild -version
        echo "============= 查找项目文件 ============="
        ls -la *.xcworkspace 2>/dev/null || echo "未找到 .xcworkspace 文件"
        ls -la *.xcodeproj 2>/dev/null || echo "未找到 .xcodeproj 文件"
        echo "============= Available Schemes ============="
        WORKSPACE_FILE=$(find . -name "*.xcworkspace" -maxdepth 1 | head -n 1)
        if [ -n "$WORKSPACE_FILE" ]; then
          echo "使用 workspace: $WORKSPACE_FILE"
          xcodebuild -workspace "$WORKSPACE_FILE" -list
        else
          echo "错误：未找到 .xcworkspace 文件"
          exit 1
        fi
 
    # 安装证书步骤
    - name: Install Certificate
      env:
        BUILD_CERTIFICATE_BASE64: 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

        P12_PASSWORD: 111111
        KEYCHAIN_PASSWORD: 111111
      run: |
        echo "$BUILD_CERTIFICATE_BASE64" | base64 --decode > certificate.p12
        security create-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security default-keychain -s build.keychain
        security unlock-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security set-keychain-settings -t 3600 -u build.keychain
        security import certificate.p12 -k build.keychain -P "$P12_PASSWORD" -T /usr/bin/codesign
        security set-key-partition-list -S apple-tool:,apple: -s -k "$KEYCHAIN_PASSWORD" build.keychain
        rm certificate.p12

    # 安装描述文件步骤
    - name: Install Provisioning Profile
      env:
        PROVISIONING_PROFILE_BASE64: MIIv0gYJKoZIhvcNAQcCoIIvwzCCL78CAQExCzAJBgUrDgMCGgUAMIIf3wYJKoZIhvcNAQcBoIIf0ASCH8w8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+Y29tNUozNkpaNUdRWjwvc3RyaW5nPgoJPGtleT5BcHBsaWNhdGlvbklkZW50aWZpZXJQcmVmaXg8L2tleT4KCTxhcnJheT4KCTxzdHJpbmc+S1k1Q1ZUQ0NDNTwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+Q3JlYXRpb25EYXRlPC9rZXk+Cgk8ZGF0ZT4yMDI1LTA3LTA4VDEwOjQ0OjQxWjwvZGF0ZT4KCTxrZXk+UGxhdGZvcm08L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPmlPUzwvc3RyaW5nPgoJCTxzdHJpbmc+eHJPUzwvc3RyaW5nPgoJCTxzdHJpbmc+dmlzaW9uT1M8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PklzWGNvZGVNYW5hZ2VkPC9rZXk+Cgk8ZmFsc2UvPgoJPGtleT5EZXZlbG9wZXJDZXJ0aWZpY2F0ZXM8L2tleT4KCTxhcnJheT4KCQk8ZGF0YT5NSUlGenpDQ0JMZWdBd0lCQWdJUVpiZHlZd0ZMV2h3YUNqRVlnVjJVckRBTkJna3Foa2lHOXcwQkFRc0ZBREIxTVVRd1FnWURWUVFERER0QmNIQnNaU0JYYjNKc1pIZHBaR1VnUkdWMlpXeHZjR1Z5SUZKbGJHRjBhVzl1Y3lCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVMTUFrR0ExVUVDd3dDUnpNeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhDekFKQmdOVkJBWVRBbFZUTUI0WERUSTFNRGN3T0RFd016TTBORm9YRFRJMk1EY3dPREV3TXpNME0xb3dnWlV4R2pBWUJnb0praWFKay9Jc1pBRUJEQXBMV1RWRFZsUkRRME0xTVRvd09BWURWUVFERERGQmNIQnNaU0JFYVhOMGNtbGlkWFJwYjI0NklFMWhjbWxoYm1VZ1FtRjFkR2x6ZEdFZ0tFdFpOVU5XVkVORFF6VXBNUk13RVFZRFZRUUxEQXBMV1RWRFZsUkRRME0xTVJrd0Z3WURWUVFLREJCTllYSnBZVzVsSUVKaGRYUnBjM1JoTVFzd0NRWURWUVFHRXdKUVNEQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU00QlJJMEY2ejFCWDFJczR3c3RiRWhrb1MzR0FvOHZGckhOQTk2RVlPc0I2Mk9ZMG4yRkVnK09hczFXM3loVElVSCtKemdsOE92QkRSTFBzUnl4bktRN2ZMZ0hoWCtqaWhUYVNtNk8zTnArRmFGQnJmN2IyWDFxMlNTalNjYk9qN2ZpMkpyVWlicFhQeEI3OWk1eE9Za3NuNTFNUHZMVXRzRnltNGpVZlNndnRhUlJuWWdOZHViWXZPa0ZEQmxEU3VxN3M5N3BIZ20yc0p0S29ONWo3bTZHbDY0dGhmbnM0clJmZXJjQ2Z6MjU3ekRxMWZqRlVIdUJPcDZVaGM5U1hqOEROb3Q3NnZ1UXFLaFJ6V0NCaWwyY0VMbFltV3NtYzR0enpPekU5c3NhanVxd2svT3FWNHp4aU5RQUY5eE96b1Y3b1d5VHYxKzNtYzZtNVVYa2pwOENBd0VBQWFPQ0FqZ3dnZ0kwTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVQ2Y3QUZaRDVyMlFLa2hLNUppaGpESmZzcDdJd2NBWUlLd1lCQlFVSEFRRUVaREJpTUMwR0NDc0dBUVVGQnpBQ2hpRm9kSFJ3T2k4dlkyVnlkSE11WVhCd2JHVXVZMjl0TDNkM1pISm5NeTVrWlhJd01RWUlLd1lCQlFVSE1BR0dKV2gwZEhBNkx5OXZZM053TG1Gd2NHeGxMbU52YlM5dlkzTndNRE10ZDNka2NtY3pNRFV3Z2dFZUJnTlZIU0FFZ2dFVk1JSUJFVENDQVEwR0NTcUdTSWIzWTJRRkFUQ0IvekNCd3dZSUt3WUJCUVVIQWdJd2diWU1nYk5TWld4cFlXNWpaU0J2YmlCMGFHbHpJR05sY25ScFptbGpZWFJsSUdKNUlHRnVlU0J3WVhKMGVTQmhjM04xYldWeklHRmpZMlZ3ZEdGdVkyVWdiMllnZEdobElIUm9aVzRnWVhCd2JHbGpZV0pzWlNCemRHRnVaR0Z5WkNCMFpYSnRjeUJoYm1RZ1kyOXVaR2wwYVc5dWN5QnZaaUIxYzJVc0lHTmxjblJwWm1sallYUmxJSEJ2YkdsamVTQmhibVFnWTJWeWRHbG1hV05oZEdsdmJpQndjbUZqZEdsalpTQnpkR0YwWlcxbGJuUnpMakEzQmdnckJnRUZCUWNDQVJZcmFIUjBjSE02THk5M2QzY3VZWEJ3YkdVdVkyOXRMMk5sY25ScFptbGpZWFJsWVhWMGFHOXlhWFI1THpBV0JnTlZIU1VCQWY4RUREQUtCZ2dyQmdFRkJRY0RBekFkQmdOVkhRNEVGZ1FVbmVpaWUxOHNCc1plVHNtMnFXNEx2SWdsVW93d0RnWURWUjBQQVFIL0JBUURBZ2VBTUJNR0NpcUdTSWIzWTJRR0FRY0JBZjhFQWdVQU1CTUdDaXFHU0liM1kyUUdBUVFCQWY4RUFnVUFNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUF0RkFpSGMxRXJtL1Zlb0dsbjROMjNhaXRuU1NlSUFCMjB5blYrMGJVcUF2N0FLSFRoTkw1ZTJxbERQWVB0QUdGVnZPckVUT1kxNjNZQmpMdXdRdW1MR3QrOE5CeHRJRlphdTdHRmtoNUZhTTFPTjR5Slg2SWJWQTA2Y3RhLzI5c0hlbUtUQkVyUStEdDZhaXF4SEw3enJSajI3eHliNnBOQTVmTTI1cHZJVTlDSFdHVERybVk1TmhGNWM0b1Z1aDJ1WWVUMnQxWDRIZ0Rkb3JkRGQwbUFYYkVPWnB3anUwV0tPUTFTbWZtZlN0cVdiL285QUg5SHNvb0xLM09KSFVTZWtnNHBwRG1Says3cUloOVM4aEdzTytOc0NWWU82UWFFMU5QSmxNS0pEay9RWlBGOE5QNFd0NTJqTGRlSU4wcmM0UmpOSjRCYkRUOHZuWjg5RThCWDwvZGF0YT4KCTwvYXJyYXk+CgoJPGtleT5ERVItRW5jb2RlZC1Qcm9maWxlPC9rZXk+Cgk8ZGF0YT5NSUlOUHdZSktvWklodmNOQVFjQ29JSU5NRENDRFN3Q0FRRXhEekFOQmdsZ2hrZ0JaUU1FQWdFRkFEQ0NBdmtHQ1NxR1NJYjNEUUVIQWFDQ0F1b0VnZ0xtTVlJQzRqQU1EQWRXWlhKemFXOXVBZ0VCTUEwTUNGQlFVVU5vWldOckFRRUFNQkFNQ2xScGJXVlViMHhwZG1VQ0FnRnNNQk1NRGtseldHTnZaR1ZOWVc1aFoyVmtBUUVBTUJrTUJFNWhiV1VNRVdOdmJUVktNelpLV2pWSFVWcGZaR2x6TUJvTUNVRndjRWxFVG1GdFpRd05ZMjl0TlVvek5rcGFOVWRSV2pBY0RBaFVaV0Z0VG1GdFpRd1FUV0Z5YVdGdVpTQkNZWFYwYVhOMFlUQWREQXhEY21WaGRHbHZia1JoZEdVWERUSTFNRGN3T0RFd05EUTBNVm93SGd3T1ZHVmhiVWxrWlc1MGFXWnBaWEl3REF3S1MxazFRMVpVUTBORE5UQWZEQTVGZUhCcGNtRjBhVzl1UkdGMFpSY05Nall3TnpBNE1UQXpNelF6V2pBZ0RCZFFjbTltYVd4bFJHbHpkSEpwWW5WMGFXOXVWSGx3WlF3RlUxUlBVa1V3SVF3SVVHeGhkR1p2Y20wd0ZRd0RhVTlUREFSNGNrOVREQWgyYVhOcGIyNVBVekFyREJ0QmNIQnNhV05oZEdsdmJrbGtaVzUwYVdacFpYSlFjbVZtYVhnd0RBd0tTMWsxUTFaVVEwTkROVEFzREFSVlZVbEVEQ1ExWW1FM1pqQTRZeTB6TkRFekxUUTBZbVl0WWpaa1ppMHlZbVJpTTJKak56TmlOalV3T3d3VlJHVjJaV3h2Y0dWeVEyVnlkR2xtYVdOaGRHVnpNQ0lFSU1NTnVlMTJiekk4WTQrQ09EcXdzNXlLQnFkc2pBWEdBTCt3QUE1aGdnRlpNSUlCQ0F3TVJXNTBhWFJzWlcxbGJuUnpjSUgzQWdFQnNJSHhNRE1NRm1Gd2NHeHBZMkYwYVc5dUxXbGtaVzUwYVdacFpYSU1HVXRaTlVOV1ZFTkRRelV1WTI5dExqVktNelpLV2pWSFVWb3dIUXdQWVhCekxXVnVkbWx5YjI1dFpXNTBEQXB3Y205a2RXTjBhVzl1TUJnTUUySmxkR0V0Y21Wd2IzSjBjeTFoWTNScGRtVUJBZjh3TVF3alkyOXRMbUZ3Y0d4bExtUmxkbVZzYjNCbGNpNTBaV0Z0TFdsa1pXNTBhV1pwWlhJTUNrdFpOVU5XVkVORFF6VXdFd3dPWjJWMExYUmhjMnN0WVd4c2IzY0JBUUF3T1F3V2EyVjVZMmhoYVc0dFlXTmpaWE56TFdkeWIzVndjekFmREF4TFdUVkRWbFJEUTBNMUxpb01EMk52YlM1aGNIQnNaUzUwYjJ0bGJxQ0NDRHd3Z2dKRE1JSUJ5YUFEQWdFQ0FnZ3R4ZnlJMHNWTGxUQUtCZ2dxaGtqT1BRUURBekJuTVJzd0dRWURWUVFEREJKQmNIQnNaU0JTYjI5MElFTkJJQzBnUnpNeEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV6QWVGdzB4TkRBME16QXhPREU1TURaYUZ3MHpPVEEwTXpBeE9ERTVNRFphTUdjeEd6QVpCZ05WQkFNTUVrRndjR3hsSUZKdmIzUWdRMEVnTFNCSE16RW1NQ1FHQTFVRUN3d2RRWEJ3YkdVZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNSFl3RUFZSEtvWkl6ajBDQVFZRks0RUVBQ0lEWWdBRW1Pa3ZQVUJ5cE8yVEluS0JFeHpkRUpYeHhhTk9jZHdVRnRrTzVhWUZLbmRrZTE5T09OTzdIRVMxZi9VZnRqSmlYY25waEZ0UE1FOFJXZ0Q5V0ZnTXBmVVBMRTBIUnhOMTJwZVhsMjh4WE8wcm5Yc2dPOWk1Vk5sZW1hUTZVUW94bzBJd1FEQWRCZ05WSFE0RUZnUVV1N0Rlb1ZnemlKcWtpcG5ldnIzcnI5ckxKS3N3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFPQmdOVkhROEJBZjhFQkFNQ0FRWXdDZ1lJS29aSXpqMEVBd01EYUFBd1pRSXhBSVBwd2NRV1hocGROQmpaN2UvMGJBNEFSa3U0MzdKR0VjVVAvZVo2aktHbWE4N0NBOVNjOVpQR2RMaHEzNm9qRlFJd2JXYUtFTXJVRGRSUHpZMURQclNLWTZVemJ1TnQyaGUzWkIvSVV5YjVpR0owT1FzWFc4dFJxQXpvR0FQbm9ySW9NSUlDNWpDQ0FtMmdBd0lCQWdJSU13M3UrTDlNYUM0d0NnWUlLb1pJemowRUF3TXdaekViTUJrR0ExVUVBd3dTUVhCd2JHVWdVbTl2ZENCRFFTQXRJRWN6TVNZd0pBWURWUVFMREIxQmNIQnNaU0JEWlhKMGFXWnBZMkYwYVc5dUlFRjFkR2h2Y21sMGVURVRNQkVHQTFVRUNnd0tRWEJ3YkdVZ1NXNWpMakVMTUFrR0ExVUVCaE1DVlZNd0hoY05NVGN3TWpJeU1qSXlNekl5V2hjTk16SXdNakU0TURBd01EQXdXakJ5TVNZd0pBWURWUVFEREIxQmNIQnNaU0JUZVhOMFpXMGdTVzUwWldkeVlYUnBiMjRnUTBFZ05ERW1NQ1FHQTFVRUN3d2RRWEJ3YkdVZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVCbXVrVm05OW55ZlJ6amFPa2h0V3pWUTJaRXJKbEdpWitza2dmdUwxV0EvYzRtcnJHVWN2THU4N3BBRzBBUk5FZkZvbXJhQ2NLU1dLNWVZR2IwOThXcU9COXpDQjlEQVBCZ05WSFJNQkFmOEVCVEFEQVFIL01COEdBMVVkSXdRWU1CYUFGTHV3M3FGWU00aWFwSXFaM3I2OTY2L2F5eVNyTUVZR0NDc0dBUVVGQndFQkJEb3dPREEyQmdnckJnRUZCUWN3QVlZcWFIUjBjRG92TDI5amMzQXVZWEJ3YkdVdVkyOXRMMjlqYzNBd015MWhjSEJzWlhKdmIzUmpZV2N6TURjR0ExVWRId1F3TUM0d0xLQXFvQ2lHSm1oMGRIQTZMeTlqY213dVlYQndiR1V1WTI5dEwyRndjR3hsY205dmRHTmhaek11WTNKc01CMEdBMVVkRGdRV0JCUjZSN280aWhVa1NDSkd6YjZQR2lSN05BTXFhVEFPQmdOVkhROEJBZjhFQkFNQ0FRWXdFQVlLS29aSWh2ZGpaQVlDRVFRQ0JRQXdDZ1lJS29aSXpqMEVBd01EWndBd1pBSXdGUXlwanNhdmxtbHJwNS9kWE5RRFdXeXVVdFJneG90MjRMZkZvdkVKZk9DYTQydXg0M3d4eENkNnA0NkovYXQzQWpCaE15RHhLZi81aHpLdUtjaGtQWFo3VWFUU0FpOTJ2bUFpa2ZIVk9uWGN0T0xHS3BiK3hnbmNTay9WSlBEOHlySXdnZ01ITUlJQ3JhQURBZ0VDQWdnWGdLZzBabVRxeXpBS0JnZ3Foa2pPUFFRREFqQnlNU1l3SkFZRFZRUUREQjFCY0hCc1pTQlRlWE4wWlcwZ1NXNTBaV2R5WVhScGIyNGdRMEVnTkRFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEkwTVRFeU1EQXpNakEwTlZvWERUSTRNVEl4TkRFNE1EQXpNRm93VGpFcU1DZ0dBMVVFQXd3aFYxZEVVaUJRY205MmFYTnBiMjVwYm1jZ1VISnZabWxzWlNCVGFXZHVhVzVuTVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCUFdVV3c3QjFGUS9HZDVHWUNWZlBvNHB6MnhQazlVY3QzMjJVbDhmNGZ0akFiS0NHNmloVHJUVDdlOVd1UmZVbU0xZ3Q4NU9xYmM2VjNaVDZETkRyMzJqZ2dGUE1JSUJTekFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUFGSHBIdWppS0ZTUklJa2JOdm84YUpIczBBeXBwTUVFR0NDc0dBUVVGQndFQkJEVXdNekF4QmdnckJnRUZCUWN3QVlZbGFIUjBjRG92TDI5amMzQXVZWEJ3YkdVdVkyOXRMMjlqYzNBd015MWhjMmxqWVRRd016Q0JsZ1lEVlIwZ0JJR09NSUdMTUlHSUJna3Foa2lHOTJOa0JRRXdlekI1QmdnckJnRUZCUWNDQWpCdERHdFVhR2x6SUdObGNuUnBabWxqWVhSbElHbHpJSFJ2SUdKbElIVnpaV1FnWlhoamJIVnphWFpsYkhrZ1ptOXlJR1oxYm1OMGFXOXVjeUJwYm5SbGNtNWhiQ0IwYnlCQmNIQnNaU0JRY205a2RXTjBjeUJoYm1RdmIzSWdRWEJ3YkdVZ2NISnZZMlZ6YzJWekxqQWRCZ05WSFE0RUZnUVU2VkxPRGJER2lCcGxTcmliRVkveDNCNUhGSHd3RGdZRFZSMFBBUUgvQkFRREFnZUFNQThHQ1NxR1NJYjNZMlFNRXdRQ0JRQXdDZ1lJS29aSXpqMEVBd0lEU0FBd1JRSWhBTythdkYyZ1dtWnNaTG5OTjVPcFU3UTN4Y2RzNFlQNkZ4cmVDejNXcTJobUFpQjRJOW5EaUFkSlBmWDdpWStRYmxqZ1Y1OWovMWpoMW85Y21HUFdPajQvblRHQ0FkY3dnZ0hUQWdFQk1INHdjakVtTUNRR0ExVUVBd3dkUVhCd2JHVWdVM2x6ZEdWdElFbHVkR1ZuY21GMGFXOXVJRU5CSURReEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV3SUlGNENvTkdaazZzc3dEUVlKWUlaSUFXVURCQUlCQlFDZ2dla3dHQVlKS29aSWh2Y05BUWtETVFzR0NTcUdTSWIzRFFFSEFUQWNCZ2txaGtpRzl3MEJDUVV4RHhjTk1qVXdOekE0TVRBME5EUXhXakFxQmdrcWhraUc5dzBCQ1RReEhUQWJNQTBHQ1dDR1NBRmxBd1FDQVFVQW9Rb0dDQ3FHU000OUJBTUNNQzhHQ1NxR1NJYjNEUUVKQkRFaUJDQ2ZEQjBoTUN1RUZDRlI4dC9JcWREN3ErTVd3TmxBaEMwdEFDR2tGUU1qdVRCU0Jna3Foa2lHOXcwQkNROHhSVEJETUFvR0NDcUdTSWIzRFFNSE1BNEdDQ3FHU0liM0RRTUNBZ0lBZ0RBTkJnZ3Foa2lHOXcwREFnSUJRREFIQmdVckRnTUNCekFOQmdncWhraUc5dzBEQWdJQktEQUtCZ2dxaGtqT1BRUURBZ1JITUVVQ0lEQ1JJck4yakxTbDlaMzRHZGxUWGRlOHAxMEZKTkd4V3hXVVhNdEwvTmJYQWlFQW5YQ3VVQjAvQkpEL2xwZHBIcDBZZ2RTQXV5Y05YVW5ISjRpN01WY1JXM0k9PC9kYXRhPgoJCQkJCQkJCQkJCQkJCQoJCQk8a2V5PlBQUUNoZWNrPC9rZXk+Cgk8ZmFsc2UvPgoKCTxrZXk+RW50aXRsZW1lbnRzPC9rZXk+Cgk8ZGljdD4KCQk8a2V5PmJldGEtcmVwb3J0cy1hY3RpdmU8L2tleT4KCQk8dHJ1ZS8+CgkJCQkKCQkJCTxrZXk+YXBzLWVudmlyb25tZW50PC9rZXk+CgkJPHN0cmluZz5wcm9kdWN0aW9uPC9zdHJpbmc+CgkJCQkKCQkJCTxrZXk+YXBwbGljYXRpb24taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+S1k1Q1ZUQ0NDNS5jb20uNUozNkpaNUdRWjwvc3RyaW5nPgoJCQkJCgkJCQk8a2V5PmtleWNoYWluLWFjY2Vzcy1ncm91cHM8L2tleT4KCQk8YXJyYXk+CgkJCQk8c3RyaW5nPktZNUNWVENDQzUuKjwvc3RyaW5nPgoJCQkJPHN0cmluZz5jb20uYXBwbGUudG9rZW48L3N0cmluZz4KCQk8L2FycmF5PgoJCQkJCgkJCQk8a2V5PmdldC10YXNrLWFsbG93PC9rZXk+CgkJPGZhbHNlLz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLnRlYW0taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+S1k1Q1ZUQ0NDNTwvc3RyaW5nPgoJCQoJPC9kaWN0PgoJPGtleT5FeHBpcmF0aW9uRGF0ZTwva2V5PgoJPGRhdGU+MjAyNi0wNy0wOFQxMDozMzo0M1o8L2RhdGU+Cgk8a2V5Pk5hbWU8L2tleT4KCTxzdHJpbmc+Y29tNUozNkpaNUdRWl9kaXM8L3N0cmluZz4KCTxrZXk+VGVhbUlkZW50aWZpZXI8L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPktZNUNWVENDQzU8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PlRlYW1OYW1lPC9rZXk+Cgk8c3RyaW5nPk1hcmlhbmUgQmF1dGlzdGE8L3N0cmluZz4KCTxrZXk+VGltZVRvTGl2ZTwva2V5PgoJPGludGVnZXI+MzY0PC9pbnRlZ2VyPgoJPGtleT5VVUlEPC9rZXk+Cgk8c3RyaW5nPjVi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
        
      run: |
        echo "$PROVISIONING_PROFILE_BASE64" | base64 --decode > provisioning.mobileprovision
        mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
        cp provisioning.mobileprovision ~/Library/MobileDevice/Provisioning\ Profiles/
        rm provisioning.mobileprovision

    # 检查 ExportOptions.plist 文件
    - name: Check ExportOptions.plist
      run: |
        if [ -f "ExportOptions.plist" ]; then
          echo "找到 ExportOptions.plist 文件"
          cat ExportOptions.plist
        else
          echo "错误：未找到 ExportOptions.plist 文件"
          exit 1
        fi

    # 构建和归档 iOS 应用
    - name: Build and Archive iOS App
      run: |
        # 创建构建目录
        mkdir -p build
        
        # 查找 workspace 文件
        WORKSPACE_FILE=$(find . -name "*.xcworkspace" -maxdepth 1 | head -n 1)
        if [ -z "$WORKSPACE_FILE" ]; then
          echo "错误：未找到 .xcworkspace 文件"
          echo "当前目录内容："
          ls -la
          exit 1
        fi
        
        echo "使用 workspace: $WORKSPACE_FILE"
        echo "使用 scheme: Riverla"
        
        # 构建和归档
        xcodebuild -workspace "$WORKSPACE_FILE" \
          -scheme "Riverla" \
          -configuration "Release" \
          -destination 'generic/platform=iOS' \
          -archivePath "$PWD/build/App.xcarchive" \
          archive \
          -allowProvisioningUpdates

    # 导出 IPA
    - name: Export IPA
      run: |
        xcodebuild -exportArchive \
          -archivePath "$PWD/build/App.xcarchive" \
          -exportOptionsPlist ExportOptions.plist \
          -exportPath "$PWD/build/ipa"

    # 检查构建结果
    - name: Check Build Files
      run: |
        ls -la build/ipa/

    # 上传 IPA 作为 artifact
    - name: Archive IPA
      uses: actions/upload-artifact@v4
      with:
        name: release-ipa
        path: build/ipa/*.ipa

    # 上传到 App Store
    - name: Upload to App Store using altool
      if: github.ref == 'refs/heads/main'  # 只在 main 分支上传
      env:
        APPLE_ID: "marianebautista76@outlook.com"
        APP_SPECIFIC_PASSWORD: "azqi-stfd-bkkl-sqfv"
      run: |
        # 查找生成的 IPA 文件
        IPA_FILE=$(find build/ipa -name "*.ipa" | head -n 1)
        if [ -z "$IPA_FILE" ]; then
          echo "错误：未找到 IPA 文件"
          exit 1
        fi
        
        echo "上传 IPA 文件: $IPA_FILE"
        xcrun altool --upload-app -f "$IPA_FILE" \
          -t ios \
          -u "$APPLE_ID" \
          -p "$APP_SPECIFIC_PASSWORD" \
          --verbose

    # 清理
    - name: Cleanup
      if: always()
      run: |
        # 删除临时 keychain
        security delete-keychain build.keychain || true 
