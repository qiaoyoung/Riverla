
#import <Foundation/Foundation.h>

NSString *StringFromMyBubbleData(Byte *data);        


//: #ffffff
Byte kStr_highlightText[] = {33, 7, 89, 9, 12, 88, 85, 176, 158, 202, 13, 13, 13, 13, 13, 13, 219};


//: %@\n%@\n%@\n%@
Byte kStr_withText[] = {75, 11, 46, 4, 247, 18, 220, 247, 18, 220, 247, 18, 220, 247, 18, 208};


//: #8A8E98
Byte kStr_contentStatusData[] = {53, 7, 43, 12, 131, 180, 100, 28, 151, 192, 115, 81, 248, 13, 22, 13, 26, 14, 13, 128};


//: #000000
Byte kStr_videoChangeData[] = {71, 7, 76, 7, 23, 232, 69, 215, 228, 228, 228, 228, 228, 228, 42};


//: B391FF
Byte kStr_videoTingValue[] = {18, 6, 36, 4, 30, 15, 21, 13, 34, 34, 38};


//: common_bg
Byte kStr_withViewText[] = {78, 9, 73, 4, 26, 38, 36, 36, 38, 37, 22, 25, 30, 136};


//: contact_list_activity_most
Byte kStr_cellTingTitle[] = {37, 26, 98, 7, 62, 217, 41, 1, 13, 12, 18, 255, 1, 18, 253, 10, 7, 17, 18, 253, 255, 1, 18, 7, 20, 7, 18, 23, 253, 11, 13, 17, 18, 57};


//: jpg
Byte kStr_directionValue[] = {37, 3, 27, 10, 57, 236, 12, 157, 73, 63, 79, 85, 76, 39};


//: tips_push_content_3
Byte kStr_videoTimeValue[] = {33, 19, 61, 6, 24, 2, 55, 44, 51, 54, 34, 51, 56, 54, 43, 34, 38, 50, 49, 55, 40, 49, 55, 34, 246, 35};


//: code
Byte kStr_bubbleSizeData[] = {59, 4, 92, 14, 132, 175, 191, 145, 74, 177, 233, 238, 22, 236, 7, 19, 8, 9, 50};


//: feedback_activity_submit
Byte kStr_selectedContent[] = {17, 24, 34, 9, 182, 219, 46, 43, 32, 68, 67, 67, 66, 64, 63, 65, 73, 61, 63, 65, 82, 71, 84, 71, 82, 87, 61, 81, 83, 64, 75, 71, 82, 175};


//: tips_push_content
Byte kStr_tableWithName[] = {81, 17, 85, 9, 154, 176, 109, 143, 68, 31, 20, 27, 30, 10, 27, 32, 30, 19, 10, 14, 26, 25, 31, 16, 25, 31, 201};


//: #2B2F36
Byte kStr_recordStatusName[] = {40, 7, 42, 12, 106, 8, 112, 42, 159, 204, 41, 175, 249, 8, 24, 8, 28, 9, 12, 84};


//: upload_picture
Byte kStr_tingText[] = {47, 14, 34, 12, 130, 100, 142, 151, 107, 202, 176, 164, 83, 78, 74, 77, 63, 66, 61, 78, 71, 65, 82, 83, 80, 67, 89};


//: message_send_camera
Byte kStr_collectionWithText[] = {8, 19, 74, 4, 35, 27, 41, 41, 23, 29, 27, 21, 41, 27, 36, 26, 21, 25, 23, 35, 27, 40, 23, 247};


//: back_arrow_bl
Byte kStr_blueStatusContent[] = {13, 13, 34, 11, 27, 221, 241, 177, 38, 89, 177, 64, 63, 65, 73, 61, 63, 80, 80, 77, 85, 61, 64, 74, 223};


//: /friend/add
Byte kStr_contentImageData[] = {87, 11, 59, 12, 63, 212, 54, 41, 78, 21, 246, 200, 244, 43, 55, 46, 42, 51, 41, 244, 38, 41, 41, 51};


//: content
Byte kStr_infoData[] = {18, 7, 51, 13, 104, 209, 12, 250, 54, 147, 1, 160, 133, 48, 60, 59, 65, 50, 59, 65, 84};


//: picture
Byte kStr_intervalValue[] = {8, 7, 7, 12, 255, 75, 173, 195, 210, 185, 44, 242, 105, 98, 92, 109, 110, 107, 94, 153};


//: tips_push_content_2
Byte kStr_shouldContent[] = {86, 19, 69, 11, 229, 36, 196, 245, 234, 234, 2, 47, 36, 43, 46, 26, 43, 48, 46, 35, 26, 30, 42, 41, 47, 32, 41, 47, 26, 237, 3};


//: tips_push_content_1
Byte kStr_formatText[] = {38, 19, 32, 13, 191, 75, 7, 75, 174, 240, 45, 143, 4, 84, 73, 80, 83, 63, 80, 85, 83, 72, 63, 67, 79, 78, 84, 69, 78, 84, 63, 17, 81};


//: message_send_album
Byte kStr_tableSizeName[] = {16, 18, 3, 12, 85, 206, 203, 109, 166, 207, 193, 83, 106, 98, 112, 112, 94, 100, 98, 92, 112, 98, 107, 97, 92, 94, 105, 95, 114, 106, 58};


//: group_info_activity_update_failed
Byte kStr_disableTableFileTitle[] = {99, 33, 68, 11, 201, 179, 156, 18, 36, 20, 84, 35, 46, 43, 49, 44, 27, 37, 42, 34, 43, 27, 29, 31, 48, 37, 50, 37, 48, 53, 27, 49, 44, 32, 29, 48, 33, 27, 34, 29, 37, 40, 33, 32, 119};


//: #CCECFC
Byte kStr_withRecordName[] = {91, 7, 24, 10, 118, 145, 57, 232, 9, 3, 11, 43, 43, 45, 43, 46, 43, 12};


//: #F7D2F3
Byte kStr_timeBackgroundData[] = {67, 7, 4, 12, 186, 252, 8, 197, 27, 252, 234, 5, 31, 66, 51, 64, 46, 66, 47, 230};


//: ic_album
Byte kStr_areaEnableRemoteData[] = {35, 8, 39, 6, 118, 218, 66, 60, 56, 58, 69, 59, 78, 70, 46};


//: tips_push
Byte kStr_contentIndexTitle[] = {95, 9, 85, 13, 130, 31, 175, 106, 201, 42, 183, 7, 147, 31, 20, 27, 30, 10, 27, 32, 30, 19, 85};


//: ic_camera
Byte kStr_providerData[] = {62, 9, 9, 11, 74, 114, 3, 9, 83, 179, 237, 96, 90, 86, 90, 88, 100, 92, 105, 88, 127};

// __DEBUG__
// __CLOSE_PRINT__
//
//  RangeMaxViewController.m
//  Riverla
//
//  Created by mac on 2025/4/1.
//  Copyright © 2025 Riverla. All rights reserved.
//

// __M_A_C_R_O__
//: #import "DisCorveyPublishViewController.h"
#import "RangeMaxViewController.h"
//: #import "TZTestCell.h"
#import "FrameViewCell.h"
//: #import "TZImagePickerController.h"
#import "TZImagePickerController.h"
//: #import "FUBeautyViewController.h"
#import "ActionViewController.h"
//: #import "FUBeautyImageRenderViewController.h"
#import "ButtonViewController.h"
//: #import "FUImageRenderViewModel.h"
#import "IngredientModel.h"
//: #import "NTESFileLocationHelper.h"
#import "MessageSearchedHelper.h"
//: #import "UIImage+FU.h"
#import "UIImage+FU.h"

//: @interface DisCorveyPublishViewController ()<UICollectionViewDataSource,UICollectionViewDelegate,TZImagePickerControllerDelegate>
@interface RangeMaxViewController ()<UICollectionViewDataSource,UICollectionViewDelegate,TZImagePickerControllerDelegate>

//: @property (nonatomic, strong) UICollectionView *collectionView;
@property (nonatomic, strong) UICollectionView *collectionView;
//: @property (nonatomic, strong) NSMutableArray *selectedPhotos;
@property (nonatomic, strong) NSMutableArray *selectedPhotos;
//: @property (nonatomic, strong) NSMutableArray *selectedAssets;
@property (nonatomic, strong) NSMutableArray *selectedAssets;

//: @property (nonatomic, strong) NSMutableArray *urlList;
@property (nonatomic, strong) NSMutableArray *urlList;

//: @property (nonatomic,strong) UIButton *btnAlbum;
@property (nonatomic,strong) UIButton *btnAlbum;
//: @property (nonatomic,strong) UIButton *btnCamera;
@property (nonatomic,strong) UIButton *btnCamera;
//: @property (nonatomic,strong) UIButton *btnSubmit;
@property (nonatomic,strong) UIButton *btnSubmit;

//: @property (nonatomic,strong) UIView *tipview;
@property (nonatomic,strong) UIView *tipview;

//: @end
@end

//: @implementation DisCorveyPublishViewController
@implementation RangeMaxViewController

//: - (void)viewWillAppear:(BOOL)animated{
- (void)viewWillAppear:(BOOL)animated{
    //: [super viewWillAppear:animated];
    [super viewWillAppear:animated];
    //: self.navigationController.navigationBarHidden = YES;
    self.navigationController.navigationBarHidden = YES;
}

//: - (void)viewWillDisappear:(BOOL)animated{
- (void)viewWillDisappear:(BOOL)animated{
    //: [super viewWillDisappear:animated];
    [super viewWillDisappear:animated];
    //: self.navigationController.navigationBarHidden = NO;
    self.navigationController.navigationBarHidden = NO;
}

//: - (void)viewDidLoad {
- (void)viewDidLoad {
    //: [super viewDidLoad];
    [super viewDidLoad];
    //: self.view.backgroundColor = [UIColor whiteColor];
    self.view.backgroundColor = [UIColor whiteColor];
    //: UIImageView *bg = [[UIImageView alloc]initWithFrame:self.view.bounds];
    UIImageView *bg = [[UIImageView alloc]initWithFrame:self.view.bounds];
    //: bg.image = [UIImage imageNamed:@"common_bg"];
    bg.image = [UIImage imageNamed:StringFromMyBubbleData(kStr_withViewText)];
    //: [self.view addSubview:bg];
    [self.view addSubview:bg];

    //: UIButton *closeBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    UIButton *closeBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    //: closeBtn.frame = CGRectMake(15, 4+[UIDevice vg_statusBarHeight], 32, 32);
    closeBtn.frame = CGRectMake(15, 4+[UIDevice clear], 32, 32);
    //: closeBtn.backgroundColor = [UIColor clearColor];
    closeBtn.backgroundColor = [UIColor clearColor];
    //: [closeBtn setImage:[UIImage imageNamed:@"back_arrow_bl"] forState:(UIControlStateNormal)];
    [closeBtn setImage:[UIImage imageNamed:StringFromMyBubbleData(kStr_blueStatusContent)] forState:(UIControlStateNormal)];
    //: [closeBtn addTarget:self action:@selector(backAction) forControlEvents:UIControlEventTouchUpInside];
    [closeBtn addTarget:self action:@selector(messageLeft) forControlEvents:UIControlEventTouchUpInside];
    //: [self.view addSubview:closeBtn];
    [self.view addSubview:closeBtn];

//    UIButton *infoBtn = [UIButton buttonWithType:UIButtonTypeCustom];
//    infoBtn.frame = CGRectMake(SCREEN_WIDTH-15-32, 4+SCREEN_STATUS_HEIGHT, 32, 32);
//    infoBtn.backgroundColor = [UIColor clearColor];
//    [infoBtn setImage:[UIImage imageNamed:@"ic_info"] forState:(UIControlStateNormal)];
//    [infoBtn addTarget:self action:@selector(infoAction) forControlEvents:UIControlEventTouchUpInside];
//    [self.view addSubview:infoBtn];

    //: _selectedPhotos = [NSMutableArray array];
    _selectedPhotos = [NSMutableArray array];
    //: _selectedAssets = [NSMutableArray array];
    _selectedAssets = [NSMutableArray array];
    //: _urlList = [NSMutableArray array];
    _urlList = [NSMutableArray array];
    //: [self configCollectionView];
    [self achromaticColour];

     //: [self.view addSubview:self.tipview];
     [self.view addSubview:self.tipview];
    //: self.tipview.frame = CGRectMake(0, (44.0f + [UIDevice vg_statusBarHeight])+300, [[UIScreen mainScreen] bounds].size.width, 150);
    self.tipview.frame = CGRectMake(0, (44.0f + [UIDevice clear])+300, [[UIScreen mainScreen] bounds].size.width, 150);

    //: [self.view addSubview:self.btnSubmit];
    [self.view addSubview:self.btnSubmit];
    //: [self.view addSubview:self.btnCamera];
    [self.view addSubview:self.btnCamera];
    //: [self.view addSubview:self.btnAlbum];
    [self.view addSubview:self.btnAlbum];
}

//: - (void)configCollectionView {
- (void)achromaticColour {
    // 设置 UICollectionView 的布局
    //: CGFloat space = 15;
    CGFloat space = 15;
    //: CGFloat width = ([[UIScreen mainScreen] bounds].size.width-4*space)/3;
    CGFloat width = ([[UIScreen mainScreen] bounds].size.width-4*space)/3;
    //: UICollectionViewFlowLayout *layout = [[UICollectionViewFlowLayout alloc] init];
    UICollectionViewFlowLayout *layout = [[UICollectionViewFlowLayout alloc] init];
    //: layout.itemSize = CGSizeMake(width, width); 
    layout.itemSize = CGSizeMake(width, width); // 每个 item 的大小
    //: layout.minimumInteritemSpacing = space; 
    layout.minimumInteritemSpacing = space; // item 之间的水平间距
    //: layout.minimumLineSpacing = space; 
    layout.minimumLineSpacing = space; // item 之间的垂直间距
    //: layout.sectionInset = UIEdgeInsetsMake(0, 0, 0, 0); 
    layout.sectionInset = UIEdgeInsetsMake(0, 0, 0, 0); // section 内的边距

    // 初始化 UICollectionView 并设置布局
    //: self.collectionView = [[UICollectionView alloc] initWithFrame:CGRectMake(15, (44.0f + [UIDevice vg_statusBarHeight])+40, [[UIScreen mainScreen] bounds].size.width-30, 200) collectionViewLayout:layout];
    self.collectionView = [[UICollectionView alloc] initWithFrame:CGRectMake(15, (44.0f + [UIDevice clear])+40, [[UIScreen mainScreen] bounds].size.width-30, 200) collectionViewLayout:layout];
    //: self.collectionView.delegate = self; 
    self.collectionView.delegate = self; // 设置代理
    //: self.collectionView.dataSource = self; 
    self.collectionView.dataSource = self; // 设置数据源
    //: self.collectionView.showsVerticalScrollIndicator = NO;
    self.collectionView.showsVerticalScrollIndicator = NO;
    //: self.collectionView.showsHorizontalScrollIndicator = NO;
    self.collectionView.showsHorizontalScrollIndicator = NO;
    //: self.collectionView.backgroundColor = [UIColor clearColor];
    self.collectionView.backgroundColor = [UIColor clearColor];
    //: [self.view addSubview:self.collectionView];
    [self.view addSubview:self.collectionView];
    //: [_collectionView registerClass:[TZTestCell class] forCellWithReuseIdentifier:@"TZTestCell"];
    [_collectionView registerClass:[FrameViewCell class] forCellWithReuseIdentifier:@"FrameViewCell"];
}

//: #pragma mark UICollectionView
#pragma mark UICollectionView
//: - (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {

    //: return _selectedPhotos.count;
    return _selectedPhotos.count;
}

//: - (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
    //: TZTestCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"TZTestCell" forIndexPath:indexPath];
    FrameViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"FrameViewCell" forIndexPath:indexPath];
    //: cell.videoImageView.hidden = YES;
    cell.videoImageView.hidden = YES;
    //: cell.layer.cornerRadius = 8;
    cell.layer.cornerRadius = 8;
    //: cell.layer.masksToBounds = YES;
    cell.layer.masksToBounds = YES;

        //: cell.imageView.image = _selectedPhotos[indexPath.item];
        cell.imageView.image = _selectedPhotos[indexPath.item];
        //: cell.deleteBtn.hidden = NO;
        cell.deleteBtn.hidden = NO;


    //: cell.deleteBtn.tag = indexPath.item;
    cell.deleteBtn.tag = indexPath.item;
    //: [cell.deleteBtn addTarget:self action:@selector(deleteBtnClik:) forControlEvents:UIControlEventTouchUpInside];
    [cell.deleteBtn addTarget:self action:@selector(infoing:) forControlEvents:UIControlEventTouchUpInside];

    //: return cell;
    return cell;
}

//: - (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {
- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {
//     // preview photos or video / 预览照片或者视频
//        PHAsset *asset = _selectedAssets[indexPath.item];
//        TZImagePickerController *imagePickerVc = [[TZImagePickerController alloc] initWithSelectedAssets:_selectedAssets selectedPhotos:_selectedPhotos index:indexPath.item];
//        imagePickerVc.maxImagesCount = 5;
//        imagePickerVc.allowPickingGif = NO;
//        imagePickerVc.autoSelectCurrentWhenDone = NO;
//        imagePickerVc.allowPickingOriginalPhoto = NO;
//        imagePickerVc.allowPickingMultipleVideo = NO;
//        imagePickerVc.showSelectedIndex = YES;
//        imagePickerVc.isSelectOriginalPhoto = _isSelectOriginalPhoto;
//        imagePickerVc.modalPresentationStyle = UIModalPresentationFullScreen;
//        [imagePickerVc setDidFinishPickingPhotosHandle:^(NSArray<UIImage *> *photos, NSArray *assets, BOOL isSelectOriginalPhoto) {
//            self->_selectedPhotos = [NSMutableArray arrayWithArray:photos];
//            self->_selectedAssets = [NSMutableArray arrayWithArray:assets];
//            self->_isSelectOriginalPhoto = isSelectOriginalPhoto;
//            [self->_collectionView reloadData];
//            self->_collectionView.contentSize = CGSizeMake(0, ((self->_selectedPhotos.count + 2) / 3 ) * (self->_margin + self->_itemWH));
//        }];
//        [self presentViewController:imagePickerVc animated:YES completion:nil];
//    
}
//: #pragma mark - Click Event
#pragma mark - Click Event
//: - (void)deleteBtnClik:(UIButton *)sender {
- (void)infoing:(UIButton *)sender {
    //: if ([self collectionView:self.collectionView numberOfItemsInSection:0] <= _selectedPhotos.count) {
    if ([self collectionView:self.collectionView numberOfItemsInSection:0] <= _selectedPhotos.count) {
        //: [self.selectedPhotos removeObjectAtIndex:sender.tag];
        [self.selectedPhotos removeObjectAtIndex:sender.tag];
        //: [self.urlList removeObjectAtIndex:sender.tag];
        [self.urlList removeObjectAtIndex:sender.tag];
        //: [self.collectionView reloadData];
        [self.collectionView reloadData];
        //: return;
        return;
    }

    //: [_selectedPhotos removeObjectAtIndex:sender.tag];
    [_selectedPhotos removeObjectAtIndex:sender.tag];
    //: [_urlList removeObjectAtIndex:sender.tag];
    [_urlList removeObjectAtIndex:sender.tag];
    //: [_collectionView performBatchUpdates:^{
    [_collectionView performBatchUpdates:^{
        //: NSIndexPath *indexPath = [NSIndexPath indexPathForItem:sender.tag inSection:0];
        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:sender.tag inSection:0];
        //: [self->_collectionView deleteItemsAtIndexPaths:@[indexPath]];
        [self->_collectionView deleteItemsAtIndexPaths:@[indexPath]];
    //: } completion:^(BOOL finished) {
    } completion:^(BOOL finished) {
        //: [self->_collectionView reloadData];
        [self->_collectionView reloadData];
    //: }];
    }];
}

//: - (void)backAction{
- (void)messageLeft{
    //: [self.navigationController popViewControllerAnimated:NO];
    [self.navigationController popViewControllerAnimated:NO];
}

//- (void)infoAction{
//    self.tipview.hidden = !self.tipview.hidden;
//}

//: - (void)onTouchSubmitButton
- (void)touchButton
{
//    if (self.urlList.count<0) {
//        //please_choose
//        return;
//    }
    //: NSString *pic = [self.urlList componentsJoinedByString:@","];
    NSString *pic = [self.urlList componentsJoinedByString:@","];
    //: NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    //: [dict setObject:pic forKey:@"picture"];
    [dict setObject:pic forKey:StringFromMyBubbleData(kStr_intervalValue)];
    //: [dict setObject:@"" forKey:@"content"];
    [dict setObject:@"" forKey:StringFromMyBubbleData(kStr_infoData)];
    @
     //: autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
     autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
    //: [ZCHttpManager postWithUrl:[NSString stringWithFormat:@"/friend/add"] params:dict isShow:YES success:^(id responseObject) {
    [PhotoManager militaryInstallationMenuMedia:[NSString stringWithFormat:StringFromMyBubbleData(kStr_contentImageData)] event:dict current:YES titleFailed:^(id responseObject) {
        @
         //: try{} @finally{} __typeof__(self) self = __weak_self__;
         try{} @finally{} __typeof__(self) self = __weak_self__;
        //: NSDictionary *resultDict = (NSDictionary *)responseObject;
        NSDictionary *resultDict = (NSDictionary *)responseObject;
        //: NSString *code = [resultDict newStringValueForKey:@"code"];
        NSString *code = [resultDict with:StringFromMyBubbleData(kStr_bubbleSizeData)];
        //: if (code.integerValue == 0) {
        if (code.integerValue == 0) {
            //: [self.navigationController popViewControllerAnimated:NO];
            [self.navigationController popViewControllerAnimated:NO];
        }
    //: } failed:^(id responseObject, NSError *error) {
    } checked:^(id responseObject, NSError *error) {
        //: NSLog(@"error:%@",error);
    //: }];
    }];


}

//: - (void)uploadThepush
- (void)contentThepush
{
    //: NSString *pic = [self.urlList componentsJoinedByString:@","];
    NSString *pic = [self.urlList componentsJoinedByString:@","];
    //: NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    //: [dict setObject:pic forKey:@"picture"];
    [dict setObject:pic forKey:StringFromMyBubbleData(kStr_intervalValue)];
    //: [dict setObject:@"" forKey:@"content"];
    [dict setObject:@"" forKey:StringFromMyBubbleData(kStr_infoData)];
    @
     //: autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
     autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
    //: [ZCHttpManager postWithUrl:[NSString stringWithFormat:@"/friend/add"] params:dict isShow:YES success:^(id responseObject) {
    [PhotoManager militaryInstallationMenuMedia:[NSString stringWithFormat:StringFromMyBubbleData(kStr_contentImageData)] event:dict current:YES titleFailed:^(id responseObject) {
        @
         //: try{} @finally{} __typeof__(self) self = __weak_self__;
         try{} @finally{} __typeof__(self) self = __weak_self__;
        //: NSDictionary *resultDict = (NSDictionary *)responseObject;
        NSDictionary *resultDict = (NSDictionary *)responseObject;
        //: NSString *code = [resultDict newStringValueForKey:@"code"];
        NSString *code = [resultDict with:StringFromMyBubbleData(kStr_bubbleSizeData)];
        //: if (code.integerValue == 0) {
        if (code.integerValue == 0) {
            //: [self.navigationController popViewControllerAnimated:NO];
            [self.navigationController popViewControllerAnimated:NO];
        }
    //: } failed:^(id responseObject, NSError *error) {
    } checked:^(id responseObject, NSError *error) {
        //: NSLog(@"error:%@",error);
    //: }];
    }];
}

//: - (void)onTouchAlbumButton
- (void)shouldMessage
{
    //: if (self.selectedPhotos.count>=3) {
    if (self.selectedPhotos.count>=3) {
        //: [self.view makeToast:[NSString stringWithFormat:@"%@ %@ 3",[FFFLanguageManager getTextWithKey:@"upload_picture"],[FFFLanguageManager getTextWithKey:@"contact_list_activity_most"]]
        [self.view makeToast:[NSString stringWithFormat:@"%@ %@ 3",[ItemManager sessionInformation:StringFromMyBubbleData(kStr_tingText)],[ItemManager sessionInformation:StringFromMyBubbleData(kStr_cellTingTitle)]]
                    //: duration:2
                    duration:2
                    //: position:CSToastPositionCenter];
                    position:CSToastPositionCenter];
        //: return;
        return;
    }
    //: [self pushTZImagePickerController];
    [self pickerCollection];

}

//: - (void)onTouchCameraButton
- (void)intervalButton
{
    //: if (self.selectedPhotos.count>=3) {
    if (self.selectedPhotos.count>=3) {
        //: [self.view makeToast:[NSString stringWithFormat:@"%@ %@ 3",[FFFLanguageManager getTextWithKey:@"upload_picture"],[FFFLanguageManager getTextWithKey:@"contact_list_activity_most"]]
        [self.view makeToast:[NSString stringWithFormat:@"%@ %@ 3",[ItemManager sessionInformation:StringFromMyBubbleData(kStr_tingText)],[ItemManager sessionInformation:StringFromMyBubbleData(kStr_cellTingTitle)]]
                    //: duration:2
                    duration:2
                    //: position:CSToastPositionCenter];
                    position:CSToastPositionCenter];
        //: return;
        return;
    }

    //: FURenderViewController *vc = [[FURenderViewController alloc] initWithViewModel:[[FUBeautyViewModel alloc] init]];
    ColorRangeViewController *vc = [[ColorRangeViewController alloc] initWithText:[[BeautyViewModel alloc] init]];
    //: vc.photoNum = self.selectedPhotos.count;
    vc.photoNum = self.selectedPhotos.count;
    //: [self.navigationController pushViewController:vc animated:YES];
    [self.navigationController pushViewController:vc animated:YES];
    //: vc.speiceBackBlock = ^(NSArray * _Nonnull imgArray) {
    vc.speiceBackBlock = ^(NSArray * _Nonnull imgArray) {
        //: [self uploadImage:imgArray];
        [self input:imgArray];

        //: dispatch_async(dispatch_get_main_queue(), ^{
        dispatch_async(dispatch_get_main_queue(), ^{
//            [self loadPicNum];
            //: [self.selectedPhotos addObjectsFromArray:imgArray];
            [self.selectedPhotos addObjectsFromArray:imgArray];
            //: [self.collectionView reloadData];
            [self.collectionView reloadData];
        //: });
        });

    //: };
    };
}

//: #pragma mark - TZImagePickerController
#pragma mark - TZImagePickerController
//: - (void)pushTZImagePickerController {
- (void)pickerCollection {

    //: TZImagePickerController *imagePickerVc = [[TZImagePickerController alloc] initWithMaxImagesCount:1 columnNumber:3 delegate:self pushPhotoPickerVc:YES];
    TZImagePickerController *imagePickerVc = [[TZImagePickerController alloc] initWithMaxImagesCount:1 columnNumber:3 delegate:self pushPhotoPickerVc:YES];

//: #pragma mark - 五类个性化设置，这些参数都可以不传，此时会走默认设置
#pragma mark - 五类个性化设置，这些参数都可以不传，此时会走默认设置
    //: imagePickerVc.selectedAssets = _selectedAssets; 
    imagePickerVc.selectedAssets = _selectedAssets; // 目前已经选中的图片数组
    //: imagePickerVc.allowTakePicture = NO; 
    imagePickerVc.allowTakePicture = NO; // 在内部显示拍照按钮
    //: imagePickerVc.allowTakeVideo = NO; 
    imagePickerVc.allowTakeVideo = NO; // 在内部显示拍视频按
    //: [imagePickerVc setUiImagePickerControllerSettingBlock:^(UIImagePickerController *imagePickerController) {
    [imagePickerVc setUiImagePickerControllerSettingBlock:^(UIImagePickerController *imagePickerController) {
        //: imagePickerController.videoQuality = UIImagePickerControllerQualityTypeHigh;
        imagePickerController.videoQuality = UIImagePickerControllerQualityTypeHigh;
    //: }];
    }];

    //: imagePickerVc.iconThemeColor = [UIColor colorWithRed:31 / 255.0 green:185 / 255.0 blue:34 / 255.0 alpha:1.0];
    imagePickerVc.iconThemeColor = [UIColor colorWithRed:31 / 255.0 green:185 / 255.0 blue:34 / 255.0 alpha:1.0];
    //: imagePickerVc.showPhotoCannotSelectLayer = YES;
    imagePickerVc.showPhotoCannotSelectLayer = YES;
    //: imagePickerVc.cannotSelectLayerColor = [[UIColor whiteColor] colorWithAlphaComponent:0.8];
    imagePickerVc.cannotSelectLayerColor = [[UIColor whiteColor] colorWithAlphaComponent:0.8];
    //: imagePickerVc.processHintStr = @"...";
    imagePickerVc.processHintStr = @"...";
    // 3. 设置是否可以选择视频/图片/原图
    //: imagePickerVc.allowPickingVideo = NO;
    imagePickerVc.allowPickingVideo = NO;
    //: imagePickerVc.allowPickingImage = YES;
    imagePickerVc.allowPickingImage = YES;
    //: imagePickerVc.allowPickingOriginalPhoto = NO;
    imagePickerVc.allowPickingOriginalPhoto = NO;
    //: imagePickerVc.allowPickingGif = NO;
    imagePickerVc.allowPickingGif = NO;
    //: imagePickerVc.allowPickingMultipleVideo = NO;
    imagePickerVc.allowPickingMultipleVideo = NO;

    // 4. 照片排列按修改时间升序
    //: imagePickerVc.sortAscendingByModificationDate = YES;
    imagePickerVc.sortAscendingByModificationDate = YES;
    //: imagePickerVc.showSelectBtn = NO;
    imagePickerVc.showSelectBtn = NO;
    //: imagePickerVc.allowCrop = NO;
    imagePickerVc.allowCrop = NO;
    //: imagePickerVc.needCircleCrop = YES;
    imagePickerVc.needCircleCrop = YES;
    // 设置竖屏下的裁剪尺寸
    //: NSInteger left = 30;
    NSInteger left = 30;
    //: NSInteger widthHeight = [[UIScreen mainScreen] bounds].size.width - 2 * left;
    NSInteger widthHeight = [[UIScreen mainScreen] bounds].size.width - 2 * left;
    //: NSInteger top = ([[UIScreen mainScreen] bounds].size.height - widthHeight) / 2;
    NSInteger top = ([[UIScreen mainScreen] bounds].size.height - widthHeight) / 2;
    //: imagePickerVc.cropRect = CGRectMake(left, top, widthHeight, widthHeight);
    imagePickerVc.cropRect = CGRectMake(left, top, widthHeight, widthHeight);
    //: imagePickerVc.scaleAspectFillCrop = YES;
    imagePickerVc.scaleAspectFillCrop = YES;
    //: imagePickerVc.statusBarStyle = UIStatusBarStyleLightContent;
    imagePickerVc.statusBarStyle = UIStatusBarStyleLightContent;
    // 设置是否显示图片序号
    //: imagePickerVc.showSelectedIndex = YES;
    imagePickerVc.showSelectedIndex = YES;
    //: imagePickerVc.navigationBar.barStyle = UIBarStyleDefault;
    imagePickerVc.navigationBar.barStyle = UIBarStyleDefault;
    //: imagePickerVc.naviTitleColor = [UIColor blackColor];
    imagePickerVc.naviTitleColor = [UIColor blackColor];
    //: imagePickerVc.barItemTextColor = [UIColor blackColor];
    imagePickerVc.barItemTextColor = [UIColor blackColor];
//: #pragma mark - 到这里为止
#pragma mark - 到这里为止

    //: [imagePickerVc setDidFinishPickingPhotosHandle:^(NSArray<UIImage *> *photos, NSArray *assets, BOOL isSelectOriginalPhoto) {
    [imagePickerVc setDidFinishPickingPhotosHandle:^(NSArray<UIImage *> *photos, NSArray *assets, BOOL isSelectOriginalPhoto) {

        //: UIImage *image = [photos.firstObject fu_processedImage];
        UIImage *image = [photos.firstObject of];
        //: FUImageRenderViewController *vc = [[FUImageRenderViewController alloc] initWithViewModel:[[FUImageRenderViewModel alloc] initWithImage:image]];
        TrifleViewController *vc = [[TrifleViewController alloc] initWithTitle:[[IngredientModel alloc] initWithLand:image]];
        //: [self.navigationController pushViewController:vc animated:YES];
        [self.navigationController pushViewController:vc animated:YES];
        @
         //: autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
         autoreleasepool{} __weak __typeof__(self) __weak_self__ = self;
        //: vc.speiceimgBackBlock = ^(NSArray *imgArray) {
        vc.speiceimgBackBlock = ^(NSArray *imgArray) {
            @
             //: try{} @finally{} __typeof__(self) self = __weak_self__;
             try{} @finally{} __typeof__(self) self = __weak_self__;
            //: [self uploadImage:imgArray];
            [self input:imgArray];

            //: dispatch_async(dispatch_get_main_queue(), ^{
            dispatch_async(dispatch_get_main_queue(), ^{
//                [self loadPicNum];
                //: [self.selectedPhotos addObjectsFromArray:imgArray];
                [self.selectedPhotos addObjectsFromArray:imgArray];
                //: [self.collectionView reloadData];
                [self.collectionView reloadData];
            //: });
            });
        //: };
        };



    //: }];
    }];

    //: imagePickerVc.modalPresentationStyle = UIModalPresentationFullScreen;
    imagePickerVc.modalPresentationStyle = UIModalPresentationFullScreen;
    //: [self presentViewController:imagePickerVc animated:YES completion:nil];
    [self presentViewController:imagePickerVc animated:YES completion:nil];
}

//: #pragma mark - Private
#pragma mark - Private
//: - (void)loadPicNum
- (void)to
{
    //: if (self.selectedPhotos.count>0) {
    if (self.selectedPhotos.count>0) {
        //: self.btnSubmit.alpha = 1;
        self.btnSubmit.alpha = 1;
        //: self.btnSubmit.userInteractionEnabled = YES;
        self.btnSubmit.userInteractionEnabled = YES;
    //: }else{
    }else{
        //: self.btnSubmit.alpha = 0.4;
        self.btnSubmit.alpha = 0.4;
        //: self.btnSubmit.userInteractionEnabled = NO;
        self.btnSubmit.userInteractionEnabled = NO;
    }
}


//: - (void)uploadImage:(NSArray *)imageArray
- (void)input:(NSArray *)imageArray
{

    //: for (UIImage *image in imageArray) {
    for (UIImage *image in imageArray) {
        //: NSString *fileName = [NTESFileLocationHelper genFilenameWithExt:@"jpg"];
        NSString *fileName = [MessageSearchedHelper random:StringFromMyBubbleData(kStr_directionValue)];
        //: NSString *filePath = [[NTESFileLocationHelper getAppDocumentPath] stringByAppendingPathComponent:fileName];
        NSString *filePath = [[MessageSearchedHelper disappearBy] stringByAppendingPathComponent:fileName];
        //: NSData *data = UIImageJPEGRepresentation(image, 0.7);
        NSData *data = UIImageJPEGRepresentation(image, 0.7);
        //: BOOL success = data && [data writeToFile:filePath atomically:YES];
        BOOL success = data && [data writeToFile:filePath atomically:YES];
        //: __weak typeof(self) wself = self;
        __weak typeof(self) wself = self;
        //: if (success) {
        if (success) {
            //: [SVProgressHUD show];
            [SVProgressHUD show];
            //: [[NIMSDK sharedSDK].resourceManager upload:filePath progress:nil completion:^(NSString * _Nullable urlString, NSError * _Nullable error) {
            [[NIMSDK sharedSDK].resourceManager upload:filePath progress:nil completion:^(NSString * _Nullable urlString, NSError * _Nullable error) {
                //: [SVProgressHUD dismiss];
                [SVProgressHUD dismiss];
                //: if (!error && wself) {
                if (!error && wself) {
                    //: NSLog(@"urlString：%@",urlString);
                    //: [_urlList addObject:urlString];
                    [_urlList addObject:urlString];
                    //: if (self.urlList.count>0) {
                    if (self.urlList.count>0) {
                        //: self.btnSubmit.alpha = 1;
                        self.btnSubmit.alpha = 1;
                        //: self.btnSubmit.userInteractionEnabled = YES;
                        self.btnSubmit.userInteractionEnabled = YES;
                    //: }else{
                    }else{
                        //: self.btnSubmit.alpha = 0.4;
                        self.btnSubmit.alpha = 0.4;
                        //: self.btnSubmit.userInteractionEnabled = NO;
                        self.btnSubmit.userInteractionEnabled = NO;
                    }
                }
            //: }];
            }];
        //: }else{
        }else{
            //: [self.view makeToast:[FFFLanguageManager getTextWithKey:@"group_info_activity_update_failed"]
            [self.view makeToast:[ItemManager sessionInformation:StringFromMyBubbleData(kStr_disableTableFileTitle)]
                        //: duration:2
                        duration:2
                        //: position:CSToastPositionCenter];
                        position:CSToastPositionCenter];
        }
    }

//    [self uploadThepush];




}

//: #pragma mark - getset
#pragma mark - getset
//: - (UIButton *)btnAlbum
- (UIButton *)btnAlbum
{
    //: CGFloat width = ([[UIScreen mainScreen] bounds].size.width-45)/2;
    CGFloat width = ([[UIScreen mainScreen] bounds].size.width-45)/2;
    //: if(!_btnAlbum){
    if(!_btnAlbum){
        //: _btnAlbum = [UIButton buttonWithType:UIButtonTypeCustom];
        _btnAlbum = [UIButton buttonWithType:UIButtonTypeCustom];
        //: _btnAlbum.frame = CGRectMake(15, [[UIScreen mainScreen] bounds].size.height-270, width, 110);
        _btnAlbum.frame = CGRectMake(15, [[UIScreen mainScreen] bounds].size.height-270, width, 110);
        //: _btnAlbum.backgroundColor = [UIColor colorWithHexString:@"#CCECFC"];
        _btnAlbum.backgroundColor = [UIColor withMax:StringFromMyBubbleData(kStr_withRecordName)];
        //: _btnAlbum.layer.cornerRadius = 12;
        _btnAlbum.layer.cornerRadius = 12;
        //: [_btnAlbum addTarget:self action:@selector(onTouchAlbumButton) forControlEvents:UIControlEventTouchUpInside];
        [_btnAlbum addTarget:self action:@selector(shouldMessage) forControlEvents:UIControlEventTouchUpInside];
        //: _btnAlbum.titleLabel.font = [UIFont systemFontOfSize:14];
        _btnAlbum.titleLabel.font = [UIFont systemFontOfSize:14];
        //: [_btnAlbum setTitleColor:[UIColor colorWithHexString:@"#000000"] forState:UIControlStateNormal];
        [_btnAlbum setTitleColor:[UIColor withMax:StringFromMyBubbleData(kStr_videoChangeData)] forState:UIControlStateNormal];
        //: [_btnAlbum setTitle:[FFFLanguageManager getTextWithKey:@"message_send_album"] forState:UIControlStateNormal];
        [_btnAlbum setTitle:[ItemManager sessionInformation:StringFromMyBubbleData(kStr_tableSizeName)] forState:UIControlStateNormal];
        //: [_btnAlbum setImage:[UIImage imageNamed:@"ic_album"] forState:UIControlStateNormal];
        [_btnAlbum setImage:[UIImage imageNamed:StringFromMyBubbleData(kStr_areaEnableRemoteData)] forState:UIControlStateNormal];
        //: [_btnAlbum layoutButtonWithEdgeInsetsStyle:(MKButtonEdgeInsetsStyleTop) imageTitleSpace:10];
        [_btnAlbum value:(MKButtonEdgeInsetsStyleTop) nameSelected:10];
        //: [self.view addSubview:_btnAlbum];
        [self.view addSubview:_btnAlbum];

    }
    //: return _btnAlbum;
    return _btnAlbum;
}

//: - (UIButton *)btnCamera
- (UIButton *)btnCamera
{
    //: CGFloat width = ([[UIScreen mainScreen] bounds].size.width-45)/2;
    CGFloat width = ([[UIScreen mainScreen] bounds].size.width-45)/2;
    //: if(!_btnCamera){
    if(!_btnCamera){
        //: _btnCamera = [UIButton buttonWithType:UIButtonTypeCustom];
        _btnCamera = [UIButton buttonWithType:UIButtonTypeCustom];
        //: _btnCamera.frame = CGRectMake(width+30, [[UIScreen mainScreen] bounds].size.height-270, width, 110);
        _btnCamera.frame = CGRectMake(width+30, [[UIScreen mainScreen] bounds].size.height-270, width, 110);
        //: _btnCamera.backgroundColor = [UIColor colorWithHexString:@"#F7D2F3"];
        _btnCamera.backgroundColor = [UIColor withMax:StringFromMyBubbleData(kStr_timeBackgroundData)];
        //: _btnCamera.layer.cornerRadius = 12;
        _btnCamera.layer.cornerRadius = 12;
        //: [_btnCamera addTarget:self action:@selector(onTouchCameraButton) forControlEvents:UIControlEventTouchUpInside];
        [_btnCamera addTarget:self action:@selector(intervalButton) forControlEvents:UIControlEventTouchUpInside];
        //: _btnCamera.titleLabel.font = [UIFont systemFontOfSize:14];
        _btnCamera.titleLabel.font = [UIFont systemFontOfSize:14];
        //: [_btnCamera setTitleColor:[UIColor colorWithHexString:@"#000000"] forState:UIControlStateNormal];
        [_btnCamera setTitleColor:[UIColor withMax:StringFromMyBubbleData(kStr_videoChangeData)] forState:UIControlStateNormal];
        //: [_btnCamera setTitle:[FFFLanguageManager getTextWithKey:@"message_send_camera"] forState:UIControlStateNormal];
        [_btnCamera setTitle:[ItemManager sessionInformation:StringFromMyBubbleData(kStr_collectionWithText)] forState:UIControlStateNormal];
        //: [_btnCamera setImage:[UIImage imageNamed:@"ic_camera"] forState:UIControlStateNormal];
        [_btnCamera setImage:[UIImage imageNamed:StringFromMyBubbleData(kStr_providerData)] forState:UIControlStateNormal];
        //: [_btnCamera layoutButtonWithEdgeInsetsStyle:(MKButtonEdgeInsetsStyleTop) imageTitleSpace:10];
        [_btnCamera value:(MKButtonEdgeInsetsStyleTop) nameSelected:10];
        //: [self.view addSubview:_btnCamera];
        [self.view addSubview:_btnCamera];

    }
    //: return _btnCamera;
    return _btnCamera;
}
//: - (UIButton *)btnSubmit
- (UIButton *)btnSubmit
{
    //: if(!_btnSubmit){
    if(!_btnSubmit){
        //: _btnSubmit = [UIButton buttonWithType:UIButtonTypeCustom];
        _btnSubmit = [UIButton buttonWithType:UIButtonTypeCustom];
        //: _btnSubmit.frame = CGRectMake(15, [[UIScreen mainScreen] bounds].size.height-48-30, [[UIScreen mainScreen] bounds].size.width-30, 48);
        _btnSubmit.frame = CGRectMake(15, [[UIScreen mainScreen] bounds].size.height-48-30, [[UIScreen mainScreen] bounds].size.width-30, 48);
        //: _btnSubmit.backgroundColor = [UIColor colorWithHexString:@"B391FF"];
        _btnSubmit.backgroundColor = [UIColor withMax:StringFromMyBubbleData(kStr_videoTingValue)];
        //: _btnSubmit.layer.cornerRadius = 12;
        _btnSubmit.layer.cornerRadius = 12;
        //: [_btnSubmit addTarget:self action:@selector(onTouchSubmitButton) forControlEvents:UIControlEventTouchUpInside];
        [_btnSubmit addTarget:self action:@selector(touchButton) forControlEvents:UIControlEventTouchUpInside];
        //: _btnSubmit.titleLabel.font = [UIFont systemFontOfSize:16];
        _btnSubmit.titleLabel.font = [UIFont systemFontOfSize:16];
        //: [_btnSubmit setTitleColor:[UIColor colorWithHexString:@"#ffffff"] forState:UIControlStateNormal];
        [_btnSubmit setTitleColor:[UIColor withMax:StringFromMyBubbleData(kStr_highlightText)] forState:UIControlStateNormal];
        //: [_btnSubmit setTitle:[FFFLanguageManager getTextWithKey:@"feedback_activity_submit"] forState:UIControlStateNormal];
        [_btnSubmit setTitle:[ItemManager sessionInformation:StringFromMyBubbleData(kStr_selectedContent)] forState:UIControlStateNormal];
        //: _btnSubmit.alpha = 0.4;
        _btnSubmit.alpha = 0.4;
        //: _btnSubmit.userInteractionEnabled = NO;
        _btnSubmit.userInteractionEnabled = NO;
        //: [self.view addSubview:_btnSubmit];
        [self.view addSubview:_btnSubmit];

    }
    //: return _btnSubmit;
    return _btnSubmit;
}

//: - (UIView *)tipview
- (UIView *)tipview
{
    //: if (!_tipview) {
    if (!_tipview) {
        //: _tipview = [[UIView alloc]init];
        _tipview = [[UIView alloc]init];

        //: UILabel *lab = [[UILabel alloc]initWithFrame:CGRectMake(15, 0, [[UIScreen mainScreen] bounds].size.width-30, 20)];
        UILabel *lab = [[UILabel alloc]initWithFrame:CGRectMake(15, 0, [[UIScreen mainScreen] bounds].size.width-30, 20)];
        //: lab.text = [FFFLanguageManager getTextWithKey:@"tips_push"];
        lab.text = [ItemManager sessionInformation:StringFromMyBubbleData(kStr_contentIndexTitle)];
        //: lab.textColor = [UIColor colorWithHexString:@"#2B2F36"];
        lab.textColor = [UIColor withMax:StringFromMyBubbleData(kStr_recordStatusName)];
        //: lab.font = [UIFont boldSystemFontOfSize:16];
        lab.font = [UIFont boldSystemFontOfSize:16];
        //: [_tipview addSubview:lab];
        [_tipview addSubview:lab];

        //: UITextView *contentTextView = [[UITextView alloc] initWithFrame:CGRectMake(15, lab.bottom+5, [[UIScreen mainScreen] bounds].size.width-30, 130)];
        UITextView *contentTextView = [[UITextView alloc] initWithFrame:CGRectMake(15, lab.bottom+5, [[UIScreen mainScreen] bounds].size.width-30, 130)];
        //: contentTextView.textColor = [UIColor colorWithHexString:@"#8A8E98"];
        contentTextView.textColor = [UIColor withMax:StringFromMyBubbleData(kStr_contentStatusData)];
        //: contentTextView.font = [UIFont systemFontOfSize:14.f];
        contentTextView.font = [UIFont systemFontOfSize:14.f];
        //: contentTextView.text = [NSString stringWithFormat:@"%@\n%@\n%@\n%@",[FFFLanguageManager getTextWithKey:@"tips_push_content"],[FFFLanguageManager getTextWithKey:@"tips_push_content_1"],[FFFLanguageManager getTextWithKey:@"tips_push_content_2"],[FFFLanguageManager getTextWithKey:@"tips_push_content_3"]];
        contentTextView.text = [NSString stringWithFormat:StringFromMyBubbleData(kStr_withText),[ItemManager sessionInformation:StringFromMyBubbleData(kStr_tableWithName)],[ItemManager sessionInformation:StringFromMyBubbleData(kStr_formatText)],[ItemManager sessionInformation:StringFromMyBubbleData(kStr_shouldContent)],[ItemManager sessionInformation:StringFromMyBubbleData(kStr_videoTimeValue)]];
        //: [_tipview addSubview:contentTextView];
        [_tipview addSubview:contentTextView];

    }
    //: return _tipview;
    return _tipview;
}

//: @end
@end

Byte * MyBubbleDataToCache(Byte *data) {
    int line = data[0];
    int periodicTable = data[1];
    Byte far = data[2];
    int add = data[3];
    if (!line) return data + add;
    for (int i = add; i < add + periodicTable; i++) {
        int value = data[i] + far;
        if (value > 255) {
            value -= 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[add + periodicTable] = 0;
    return data + add;
}

NSString *StringFromMyBubbleData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)MyBubbleDataToCache(data)];
}
